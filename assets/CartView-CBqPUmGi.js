import{_ as S,j as C,s as q,f as y,o as _,c as f,b as a,u as l,a as e,F as E,g as T,t as b,k as $,v as M,r as h,w as k,n as V,l as U,h as N,S as F,m as L,p as B,q as D,d as j,R as P}from"./index-ckO0Meki.js";import{u as Y}from"./index-DW9dmB_l.js";import{u as A}from"./index-DA4BbhiV.js";const O={class:"position-relative"},z={class:"d-flex justify-content-between align-items-center"},H={class:"table align-middle"},G={class:"table-group-divider border-bottom border-primary"},Q={class:"product-image"},J=["src","alt"],K={class:"product-info"},W={class:"d-flex flex-column justify-content-between"},X={class:"fs-5 fs-md-3"},Z={class:"text-info"},I={class:"text-primary text-opacity-75"},ee={class:"product-qty"},te={class:"d-flex align-items-center gap-2"},se={class:"position-relative border-custom"},oe=["disabled","onClick"],le=["onUpdate:modelValue","onChange","disabled"],ae=["disabled","onClick"],ne=["onClick"],re={class:"product-total text-end"},ie={__name:"CartTable",setup(w){const s=C(),{cart:u,cartLoading:c}=q(s),{clearCart:d,deleteCartItem:p,updateCartItem:v}=C(),g=(n,t)=>{let m=parseInt(t.target.value)<1||isNaN(parseInt(t.target.value))?1:parseInt(t.target.value);v(n,m)};return(n,t)=>{const m=y("VLoading");return _(),f("div",O,[a(m,{active:l(c),"is-full-page":!1},null,8,["active"]),e("div",z,[t[1]||(t[1]=e("h2",{class:"fw-bold"},"購物車",-1)),e("button",{type:"button",class:"bg-transparent border-0 text-primary text-decoration-underline",onClick:t[0]||(t[0]=(...o)=>l(d)&&l(d)(...o))},"清空購物車")]),e("table",H,[t[3]||(t[3]=e("thead",{class:"thead"},[e("tr",null,[e("th",null,"商品"),e("th",{class:"d-none d-md-table-cell"}),e("th",{class:"d-none d-md-table-cell"},"數量"),e("th",{class:"text-end"},"小計")])],-1)),e("tbody",G,[(_(!0),f(E,null,T(l(u).carts,o=>(_(),f("tr",{key:o.id,class:"product-row"},[e("td",Q,[e("img",{src:o.product.imageUrl,alt:`${o.product.title}的照片`,class:"border border-primary"},null,8,J)]),e("td",K,[e("div",W,[e("h3",X,b(o.product.title),1),e("span",Z,b(o.product.category),1),e("span",I,"$"+b(o.product.price),1)])]),e("td",ee,[e("div",te,[e("div",se,[e("button",{type:"button",class:"position-absolute h-100 start-0 border-0 bg-transparent ps-4",disabled:l(c),onClick:i=>l(v)(o,o.qty-1)},"-",8,oe),$(e("input",{type:"number",name:"qty",id:"qty","onUpdate:modelValue":i=>o.qty=i,onChange:i=>g(o,i),class:"bg-secondary rounded",disabled:l(c)},null,40,le),[[M,o.qty]]),e("button",{type:"button",class:"position-absolute h-100 end-0 border-0 bg-transparent pe-4",disabled:l(c),onClick:i=>l(v)(o,o.qty+1)},"+",8,ae)]),e("button",{class:"btn btn-primary",onClick:i=>l(p)(o)},t[2]||(t[2]=[e("i",{class:"bi bi-trash3"},null,-1)]),8,ne)])]),e("td",re," $"+b(o.final_total),1)]))),128))])])])}}},de=S(ie,[["__scopeId","data-v-4e209fe5"]]),ue={BASE_URL:"/GDiner/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_PATH:"payzoom",VITE_URL:"https://vue3-course-api.hexschool.io"},ce={class:"position-relative container"},me={class:"container"},pe={class:"mb-8 row gy-8"},ve={class:"col-12 col-md-8"},_e={class:"row gy-8"},fe={class:"col-12"},be={class:"form-floating"},ye={class:"col-6"},ge={class:"form-floating"},Ve={class:"col-6"},$e={class:"form-floating"},he={class:"col-12"},xe={class:"form-floating"},Ce={class:"col-12 col-md-4"},ke={class:"border-custom p-4 fs-5"},we={class:"form-check"},Se={class:"form-check"},Ee={class:"mb-4"},Ue={__name:"CartForm",setup(w){const s=h({user:{email:"",name:"",tel:"",address:"阿橘飯店",type:"內用",reservation_date:"",reservation_time:""},message:""}),u=h(null),c=n=>/^(09)[0-9]{8}$/.test(n)?!0:"請輸入正確的電話號碼",d=h(!1),p=C(),v=async()=>{const{VITE_URL:n,VITE_PATH:t}=ue;try{d.value=!0;const m=await N.post(`${n}/v2/api/${t}/order`,{data:s.value});u.value.resetForm(),F.fire({icon:"success",title:`${m.data.message}`,text:`感謝您的訂購，訂單號碼： ${m.data.orderId}`,confirmButtonColor:"#3D081B"})}catch(m){F.fire({icon:"error",title:"錯誤",text:`${m.response.data.message}`,confirmButtonColor:"#3D081B"})}finally{d.value=!1,p.getCart()}},g=A(Y(),"YYYY-MM-DD");return(n,t)=>{const m=y("VLoading"),o=y("VField"),i=y("ErrorMessage"),R=y("VForm");return _(),f("div",ce,[a(m,{active:d.value,"is-full-page":!1},null,8,["active"]),a(R,{onSubmit:v,autocomplete:"off",ref_key:"formRef",ref:u},{default:k(({errors:x})=>[e("div",me,[e("div",pe,[e("div",ve,[t[12]||(t[12]=e("h3",{class:"mb-8 fw-bold"},"顧客資訊",-1)),e("div",_e,[e("div",fe,[e("div",be,[a(o,{type:"email",name:"Email",id:"email",class:V(["form-control border-custom",{"is-invalid":x.Email}]),placeholder:"請輸入 Email",rules:"required|email",modelValue:s.value.user.email,"onUpdate:modelValue":t[0]||(t[0]=r=>s.value.user.email=r)},null,8,["class","modelValue"]),t[8]||(t[8]=e("label",{for:"email"},"Email",-1)),a(i,{name:"Email",class:"invalid-feedback"})])]),e("div",ye,[e("div",ge,[a(o,{type:"text",name:"姓名",id:"name",class:V(["form-control border-custom",{"is-invalid":x.姓名}]),rules:"required",placeholder:"請輸入 姓名",modelValue:s.value.user.name,"onUpdate:modelValue":t[1]||(t[1]=r=>s.value.user.name=r)},null,8,["class","modelValue"]),t[9]||(t[9]=e("label",{for:"姓名"},"姓名",-1)),a(i,{name:"姓名",class:"invalid-feedback"})])]),e("div",Ve,[e("div",$e,[a(o,{type:"tel",name:"電話",id:"tel",class:V(["form-control border-custom",{"is-invalid":x.電話}]),rules:c,placeholder:"請輸入 電話",modelValue:s.value.user.tel,"onUpdate:modelValue":t[2]||(t[2]=r=>s.value.user.tel=r)},null,8,["class","modelValue"]),t[10]||(t[10]=e("label",{for:"tel"},"電話",-1)),a(i,{name:"電話",class:"invalid-feedback"})])]),e("div",he,[e("div",xe,[a(o,{as:"textarea",name:"userForm.message",id:"message",cols:"30",rows:"10",class:"form-control border-custom",modelValue:s.value.message,"onUpdate:modelValue":t[3]||(t[3]=r=>s.value.message=r),placeholder:"請輸入留言"},null,8,["modelValue"]),t[11]||(t[11]=e("label",{for:"message"},"備註",-1))])])])]),e("div",Ce,[t[19]||(t[19]=e("h3",{class:"mb-8 fw-bold"},"用餐方式",-1)),e("div",ke,[e("div",we,[$(e("input",{class:"form-check-input border-primary",type:"radio",name:"type",id:"here",value:"內用",checked:"","onUpdate:modelValue":t[4]||(t[4]=r=>s.value.user.type=r)},null,512),[[U,s.value.user.type]]),t[13]||(t[13]=e("label",{class:"form-check-label",for:"here"},"內用",-1))]),e("div",Se,[$(e("input",{class:"form-check-input border-primary",type:"radio",name:"type",id:"to_go",value:"外帶","onUpdate:modelValue":t[5]||(t[5]=r=>s.value.user.type=r)},null,512),[[U,s.value.user.type]]),t[14]||(t[14]=e("label",{class:"form-check-label",for:"to_go"},"外帶",-1))]),t[18]||(t[18]=e("hr",null,null,-1)),e("div",Ee,[t[15]||(t[15]=e("label",{for:"reservation_date",class:"form-label"},"日期",-1)),a(o,{type:"date",id:"reservation_date",name:"日期",rules:"required",pattern:"yyyy-MM-dd",class:V(["form-control border-primary",{"is-invalid":x.日期}]),min:l(g),modelValue:s.value.user.reservation_date,"onUpdate:modelValue":t[6]||(t[6]=r=>s.value.user.reservation_date=r)},null,8,["class","min","modelValue"]),a(i,{name:"日期",class:"invalid-feedback"})]),e("div",null,[t[17]||(t[17]=e("label",{for:"reservation_time",class:"form-label"},"時段",-1)),a(o,{as:"select",name:"時段",id:"reservation_time",class:V(["form-select border-primary",{"is-invalid":x.時段}]),"aria-label":"reservation time select",rules:"required",modelValue:s.value.user.reservation_time,"onUpdate:modelValue":t[7]||(t[7]=r=>s.value.user.reservation_time=r)},{default:k(()=>t[16]||(t[16]=[e("option",{value:"午餐",default:""},"午餐 11:00 ~ 14:30",-1),e("option",{value:"晚餐"},"晚餐 17:00 ~ 20:30",-1)])),_:2},1032,["class","modelValue"]),a(i,{name:"時段",class:"invalid-feedback"})])])])])]),t[20]||(t[20]=e("hr",null,null,-1)),t[21]||(t[21]=e("div",{class:"text-center"},[e("button",{type:"submit",class:"btn btn-primary btn-lg"},"送出訂單")],-1))]),_:1},512)])}}},Fe=S(Ue,[["__scopeId","data-v-226d1010"]]),Le={class:"position-relative"},qe={class:"coupon mb-8"},Me={class:"text-end"},De={key:0,class:"text-end"},Re={class:"text-danger"},Te={class:"pb-4 text-end"},Ne={__name:"CartCoupon",setup(w){const s=C(),u=h(""),c=h(!1),d=()=>{c.value=!c.value},p=h(!1),v=async g=>{p.value=!0,await s.submitCoupon(g),p.value=!1};return(g,n)=>{const t=y("VLoading"),m=y("VForm");return _(),f(E,null,[e("div",Le,[a(t,{active:p.value,"is-full-page":!1},null,8,["active"]),e("div",qe,[$(e("p",Me,[e("a",{class:"text-decoration-underline link-opacity-75-hover",href:"#",onClick:B(d,["prevent"])},"優惠券")],512),[[L,!c.value]]),$(e("div",null,[a(m,{onSubmit:n[1]||(n[1]=o=>v(u.value)),autocomplete:"off",class:"d-flex gap-2 justify-content-end"},{default:k(({errors:o})=>[e("div",null,[$(e("input",{type:"text",class:V(["form-control border-custom",{"is-invalid":o.優惠券}]),name:"優惠券",id:"優惠券",rules:"required",placeholder:"請輸入優惠券代碼","onUpdate:modelValue":n[0]||(n[0]=i=>u.value=i)},null,2),[[M,u.value]])]),n[2]||(n[2]=e("button",{class:"btn btn-outline-primary text-nowrap",type:"submit"},"使用",-1))]),_:1})],512),[[L,c.value]])]),l(s).cart.carts[0].coupon?(_(),f("div",De,[e("p",null,"已套用優惠券："+b(l(s).cart.carts[0].coupon.code),1),e("p",null,"餐點總價： "+b(l(s).cart.total),1),e("p",Re,"折扣金額： "+b(Math.floor(l(s).cart.final_total-l(s).cart.total)),1)])):D("",!0),e("h3",Te,"總計：$ "+b(Math.floor(l(s).cart.final_total)),1)]),n[3]||(n[3]=e("hr",null,null,-1))],64)}}},Be=S(Ne,[["__scopeId","data-v-6e2226cc"]]),je={class:"position-relative container py-8 min-vh-75"},Pe={key:1,class:"text-center min-vh-75 content-center"},ze={__name:"CartView",setup(w){const s=C(),{cart:u}=q(s);return(c,d)=>{var p,v;return _(),f("div",je,[((p=l(u).carts)==null?void 0:p.length)>0?(_(),f(E,{key:0},[a(de),a(Be),a(Fe)],64)):l(u).carts&&((v=l(u).carts)==null?void 0:v.length)===0?(_(),f("div",Pe,[d[1]||(d[1]=e("h2",{class:"mb-8 text-center"},"目前購物車為空 (´⊙ω⊙`)",-1)),a(l(P),{to:"/products",class:"btn btn-info px-5 py-3"},{default:k(()=>d[0]||(d[0]=[j("趕緊購物去")])),_:1})])):D("",!0)])}}};export{ze as default};

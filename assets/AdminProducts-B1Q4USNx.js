import{S as g}from"./sweetalert2.all-DF4Yg8So.js";import{a as C}from"./axios-Bo0ATomq.js";import{L as R}from"./index-pYsHbBkW.js";import{r as f,w as A,d as I,e as u,f as c,i as n,j as S,g as e,t as y,n as _,F as z,A as L,p as M,v as N,q as B,m as q,C as O,y as F,z as H,o as j,l as G,I as J}from"./index-owVnkv8S.js";import{_ as K}from"./plugin-vueexport-helper-DlAUqK2U.js";import{P as Q}from"./PaginationComp-UU33teoi.js";var W={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payzoom",BASE_URL:"/GDiner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const i=x=>(F("data-v-abf24872"),x=x(),H(),x),X={class:"bg-primary p-4 flex justify-between items-center"},Y={class:"text-white"},Z={class:"grid grid-cols-12 gap-6 p-3"},ee={class:"col-span-4"},te={class:"input-group"},oe=i(()=>e("label",{for:"imagUrl",class:"block"},"主要圖片",-1)),se=["src"],le={action:"/api/thisismycourse2/admin/upload",enctype:"multipart/form-data",method:"post",class:"my-4"},ae=i(()=>e("h4",{class:"font-size-5 mb-4"},"多圖新增",-1)),ie={class:"flex justify-between mb-2"},ne={for:"images-1"},re=["onClick"],de={class:"input-group"},ue=["onUpdate:modelValue"],ce=["src"],pe={action:"/api/thisismycourse2/admin/upload",enctype:"multipart/form-data",method:"post",class:"mt-10"},me={class:"col-span-8"},ve={class:"grid grid-cols-2 gap-col-6 gap-row-4"},_e={class:"input-group col-span-2"},ge=i(()=>e("label",{for:"title"},"名稱：",-1)),fe={class:"input-group"},he=i(()=>e("label",{for:"category"},"分類：",-1)),be=i(()=>e("option",{value:"主食"},"主食",-1)),xe=i(()=>e("option",{value:"沙拉"},"沙拉",-1)),ye=i(()=>e("option",{value:"湯品"},"湯品",-1)),Ve=i(()=>e("option",{value:"副食"},"副食",-1)),we=i(()=>e("option",{value:"甜點"},"甜點",-1)),$e=i(()=>e("option",{value:"飲料"},"飲料",-1)),ke=i(()=>e("option",{value:"套餐"},"套餐",-1)),Ue={class:"input-group"},Ce=i(()=>e("label",{for:"unit"},"單位：",-1)),Pe=i(()=>e("datalist",{id:"units"},[e("option",{value:"碗"}),e("option",{value:"客"}),e("option",{value:"杯"}),e("option",{value:"份"}),e("option",{value:"個"})],-1)),Ee={class:"input-group"},ze=i(()=>e("label",{for:"origin_price"},"原價：",-1)),Te={class:"input-group"},De=i(()=>e("label",{for:"price"},"售價：",-1)),Ie={class:"input-group"},Se=i(()=>e("label",{for:"veggie"},"素食:",-1)),Me=i(()=>e("option",{value:"全素",class:"text-green-700"},"全素",-1)),Le=i(()=>e("option",{value:"蛋奶素",class:"text-yellow-700"},"蛋奶素",-1)),Ne=i(()=>e("option",{value:"葷食",class:"text-red"},"葷食",-1)),qe={class:"input-group col-span-2"},Re=i(()=>e("label",{for:"tags"},"標籤：",-1)),Ae={class:"col-span-2"},Be={key:0,class:"mb-4 flex"},Oe={class:"flex"},Fe={class:"font-size-4 px-4"},He=["onClick"],je=i(()=>e("div",{class:"i-ic:baseline-close"},null,-1)),Ge=[je],Je={class:"input-group col-span-2"},Ke=i(()=>e("label",{for:"description"},"產品敘述:",-1)),Qe={class:"input-group col-span-2"},We=i(()=>e("label",{for:"content"},"內容說明:",-1)),Xe=i(()=>e("label",{for:"is_enabled"},"是否啟用",-1)),Ye={class:"text-end p-3 border-t border-solid border-#dee2e6"},Ze=i(()=>e("button",{type:"submit",class:"m-1 px-3 py-1.5 text-white bg-#0d6efd border-0 rd hover:cursor-pointer hover:bg-#0b5ed7"},"確定",-1)),et={__name:"ProductModal",props:["tempProduct","isNew"],setup(x,{expose:V}){const{VITE_URL:w,VITE_PATH:k}=W,v=x,t=f(v.tempProduct),p=f(),d=f("");function U(r){r.target.nodeName==="DIALOG"&&p.value.close()}function h(){t.value.imagesUrl||(t.value.imagesUrl=[]),t.value.imagesUrl[t.value.imagesUrl.length-1]!==""&&t.value.imagesUrl.push("")}function P(r,o){const a=o.target.files[0],l=new FormData;l.append("file-to-upload",a),C.post(`${w}/v2/api/${k}/admin/upload`,l).then(b=>{h(),r==="images"?t.value.imagesUrl[t.value.imagesUrl.length-1]=b.data.imageUrl:r==="image"&&(t.value.imageUrl=b.data.imageUrl)}).catch(b=>{g.fire({icon:"error",title:"錯誤發生",text:b.response.data.message})})}function E(){if(d.value=="")return;t.value.tags||(t.value.tags=[]);const r=t.value.tags[t.value.tags.length-1]||"";d.value===r||r==null||(t.value.tags.push(d.value),d.value="")}function T(r){const o=t.value.tags.indexOf(r);t.value.tags.splice(o,1)}return A(()=>v.tempProduct,()=>{t.value=v.tempProduct}),V({dialog:p}),(r,o)=>{const a=I("VField"),l=I("ErrorMessage"),b=I("VForm");return u(),c("dialog",{ref_key:"dialog",ref:p,class:"max-w-1140px w-100% border-0 rd p-0 backdrop:backdrop-blur-3",onClick:U},[n(b,{onSubmit:o[15]||(o[15]=m=>r.$emit("confirmProduct",t.value))},{default:S(({errors:m})=>[e("div",X,[e("h3",Y,y(x.isNew?"新增產品":"編輯產品"),1),e("button",{type:"button",class:"i-ic:baseline-close p-2 text-white font-size-4 hover:cursor-pointer",onClick:o[0]||(o[0]=s=>p.value.close())})]),e("div",null,[e("div",Z,[e("div",ee,[e("div",te,[oe,n(a,{name:"主要圖片",id:"imageUrl",type:"text",placeholder:"請輸入圖片連結",modelValue:t.value.imageUrl,"onUpdate:modelValue":o[1]||(o[1]=s=>t.value.imageUrl=s),class:_({invalid:m.主要圖片}),rules:"required"},null,8,["modelValue","class"]),n(l,{name:"主要圖片",class:"block ps-2 pt-2 text-red-500 font-size-3"}),e("img",{src:t.value.imageUrl,alt:""},null,8,se)]),e("form",le,[e("input",{type:"file",name:"file-to-upload",onChange:o[2]||(o[2]=s=>P("image",s))},null,32)]),e("div",null,[ae,(u(!0),c(z,null,L(t.value.imagesUrl,(s,$)=>(u(),c("div",{key:s,class:"mb-4"},[e("div",ie,[e("label",ne,"圖片網址"+y($+1),1),e("button",{class:"i-ic:baseline-close font-size-5 opacity-50 hover:cursor-pointer hover:opacity-75",onClick:D=>t.value.imagesUrl.splice($,1)},null,8,re)]),e("div",de,[M(e("input",{type:"text","onUpdate:modelValue":D=>t.value.imagesUrl[$]=D,placeholder:"請輸入圖片網址",class:",b-2"},null,8,ue),[[N,t.value.imagesUrl[$]]])]),e("img",{src:s,alt:""},null,8,ce)]))),128)),e("button",{type:"button",class:"inline-block w-100% bg-transparent border-#0d6efd border-solid border-1 rd text-#0d6efd py-1 mb-1",hover:"cursor-pointer bg-#0d6efd text-white",onClick:h}," 新增圖片網址 "),e("form",pe,[e("input",{type:"file",name:"file-to-upload",onChange:o[3]||(o[3]=s=>P("images",s))},null,32)])])]),e("div",me,[e("div",ve,[e("div",_e,[ge,n(a,{type:"text",id:"title",name:"名稱",rules:"required",placeholder:"請輸入標題",modelValue:t.value.title,"onUpdate:modelValue":o[4]||(o[4]=s=>t.value.title=s),class:_({invalid:m.名稱})},null,8,["modelValue","class"]),n(l,{name:"名稱",class:"block ps-2 pt-2 text-red-500 font-size-3"})]),e("div",fe,[he,n(a,{as:"select",name:"分類",rules:"required",id:"category",class:_({invalid:m.分類}),modelValue:t.value.category,"onUpdate:modelValue":o[5]||(o[5]=s=>t.value.category=s)},{default:S(()=>[be,xe,ye,Ve,we,$e,ke]),_:2},1032,["class","modelValue"]),n(l,{name:"分類",class:"block ps-2 pt-2 text-red-500 font-size-3"})]),e("div",Ue,[Ce,n(a,{type:"text",id:"unit",placeholder:"請輸入單位",modelValue:t.value.unit,"onUpdate:modelValue":o[6]||(o[6]=s=>t.value.unit=s),list:"units",name:"單位",rules:"required",class:_({invalid:m.單位}),autocomplete:"off"},null,8,["modelValue","class"]),Pe,n(l,{name:"單位",class:"block ps-2 pt-2 text-red-500 font-size-3"})]),e("div",Ee,[ze,n(a,{type:"number",name:"原價",id:"origin_price",placeholder:"請輸入原價",min:"0",rules:"required|min_value:0",class:_({invalid:m.原價}),modelValue:t.value.origin_price,"onUpdate:modelValue":o[7]||(o[7]=s=>t.value.origin_price=s),modelModifiers:{number:!0}},null,8,["class","modelValue"]),n(l,{name:"原價",class:"block ps-2 pt-2 text-red-500 font-size-3"})]),e("div",Te,[De,n(a,{type:"number",id:"price",placeholder:"請輸入售價",min:"0",modelValue:t.value.price,"onUpdate:modelValue":o[8]||(o[8]=s=>t.value.price=s),modelModifiers:{number:!0},name:"售價",rules:{required:!0,max_value:t.value.origin_price,min_value:0},class:_({invalid:m.售價})},null,8,["modelValue","rules","class"]),n(l,{name:"售價",class:"block ps-2 pt-2 text-red-500 font-size-3"})]),e("div",Ie,[Se,n(a,{as:"select",id:"veggie",modelValue:t.value.veggie,"onUpdate:modelValue":o[9]||(o[9]=s=>t.value.veggie=s),name:"素食",rules:"required",class:_({invalid:m.素食})},{default:S(()=>[Me,Le,Ne]),_:2},1032,["modelValue","class"]),n(l,{name:"素食",class:"block ps-2 pt-2 text-red-500 font-size-3"})]),e("div",qe,[Re,M(e("input",{type:"text",id:"tags","onUpdate:modelValue":o[10]||(o[10]=s=>d.value=s),onKeydown:B(E,["enter"])},null,544),[[N,d.value,void 0,{trim:!0}]])]),e("div",Ae,[t.value.tags?(u(),c("div",Be,[e("ul",Oe,[(u(!0),c(z,null,L(t.value.tags,(s,$)=>(u(),c("li",{key:`${$}+${s}`,class:"flex px-2 py-2 border-1 border-solid border-primary rd me-2"},[e("span",Fe,y(s),1),e("a",{class:"border-0 bg-transparent p-0 hover:cursor-pointer",onClick:D=>T(s)},Ge,8,He)]))),128))])])):q("",!0),e("button",{type:"button",class:"border-0 rd bg-primary text-white px-4 py-2 hover:cursor-pointer hover:bg-primary-light",onClick:E},"新增標籤")]),e("div",Je,[Ke,n(a,{as:"textarea",id:"description",rows:"6",modelValue:t.value.description,"onUpdate:modelValue":o[11]||(o[11]=s=>t.value.description=s),name:"產品敘述",rules:"required",class:_({invalid:m.產品敘述})},null,8,["modelValue","class"]),n(l,{name:"產品敘述",class:"block ps-2 pt-2 text-red-500 font-size-3"})]),e("div",Qe,[We,n(a,{as:"textarea",id:"content",rows:"4",modelValue:t.value.content,"onUpdate:modelValue":o[12]||(o[12]=s=>t.value.content=s),name:"內容說明",rules:"required",class:_({invalid:m.內容說明})},null,8,["modelValue","class"]),n(l,{name:"內容說明",class:"block ps-2 pt-2 text-red-500 font-size-3"})]),e("div",null,[M(e("input",{type:"checkbox",id:"is_enabled","onUpdate:modelValue":o[13]||(o[13]=s=>t.value.is_enabled=s),"true-value":1,"false-value":0},null,512),[[O,t.value.is_enabled]]),Xe])])])]),e("div",Ye,[e("button",{type:"button",class:"m-1 px-3 py-1.5 bg-transparent text-#6c757d border-1 border-solid border-#6c757d rd hover:cursor-pointer hover:bg-#5c636a hover:text-white",onClick:o[14]||(o[14]=s=>p.value.close())},"取消"),Ze])])]),_:1})],512)}}},tt=K(et,[["__scopeId","data-v-abf24872"]]);var ot={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payzoom",BASE_URL:"/GDiner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const st={class:"p-10"},lt=e("h2",{class:"font-size-12"},"產品",-1),at={class:"text-end mt-6"},it={class:"relative min-h-100"},nt={class:"w-100% mt-6"},rt=e("thead",{class:"border-b-1 border-black border-solid fw-bold text-left"},[e("tr",null,[e("th",{width:"120"}," 分類 "),e("th",null,"產品名稱"),e("th",{width:"120",class:"text-end"}," 原價 "),e("th",{width:"120",class:"text-end"}," 售價 "),e("th",{width:"100",class:"text-center"}," 是否啟用 "),e("th",{width:"120"}," 編輯 ")])],-1),dt={class:"text-end"},ut={class:"text-end"},ct={class:"text-center"},pt={key:0,class:"text-#198754"},mt={key:1,class:"text-red"},vt=["onClick"],_t=["onClick"],Vt={__name:"AdminProducts",setup(x){const{VITE_URL:V,VITE_PATH:w}=ot,k=f([]),v=f(),t=f({}),p=f(!0),d=f({}),U=f(!1);function h(o=1){U.value=!0,C.get(`${V}/v2/api/${w}/admin/products?page=${o}`).then(a=>{k.value=a.data.products,d.value=a.data.pagination}).catch(a=>{g.fire({icon:"error",title:"錯誤發生",text:a.response.data.message})}).finally(()=>{U.value=!1})}function P(){v.value.dialog.showModal(),t.value={},p.value=!0}function E(o){t.value=JSON.parse(JSON.stringify(o)),p.value=!1,v.value.dialog.showModal()}function T(o){if(p.value)o.created=Date.now(),C.post(`${V}/v2/api/${w}/admin/product`,{data:o}).then(a=>{g.fire({title:`${a.data.message}`,icon:"success",didClose:()=>{h(d.value.current_page||1)}}),v.value.dialog.close(),t.value={}}).catch(a=>{g.fire({icon:"error",title:"錯誤發生",text:`${a.response.data.message}`})});else{const{id:a}=o;C.put(`${V}/v2/api/${w}/admin/product/${a}`,{data:o}).then(l=>{g.fire({title:`${l.data.message}`,icon:"success",didClose:()=>{h(d.value.current_page||1)}}),v.value.dialog.close(),t.value={}}).catch(l=>{g.fire({icon:"error",title:"錯誤發生",text:`${l.response.data.message}`})})}}function r(o){g.fire({title:`你確定要刪除 ${o.title} 嗎?`,showCancelButton:!0,confirmButtonText:"確定",cancelButtonText:"取消"}).then(a=>{a.isConfirmed&&C.delete(`${V}/v2/api/${w}/admin/product/${o.id}`).then(l=>{g.fire({icon:"success",text:l.data.message,didClose:()=>{h(d.value.current_page||1)}})}).catch(l=>{g.fire({icon:"error",text:l.response.data.message})})})}return j(()=>{h()}),(o,a)=>(u(),c(z,null,[e("div",st,[lt,e("div",at,[e("button",{type:"button",class:"bg-primary border-0 text-white cursor-pointer inline-block px-3 py-1.5 rd font-size-4 hover:bg-primary-light",onClick:a[0]||(a[0]=l=>P())},"建立新的產品")]),e("div",it,[n(G(R),{active:U.value,"is-full-page":!1},null,8,["active"]),e("table",nt,[rt,e("tbody",null,[(u(!0),c(z,null,L(k.value,l=>(u(),c("tr",{class:"border-b border-#DEE2E6 border-solid",key:l.id},[e("td",null,y(l.category),1),e("td",null,y(l.title),1),e("td",dt,y(l.origin_price),1),e("td",ut,y(l.price),1),e("td",ct,[l.is_enabled?(u(),c("span",pt,"啟用")):(u(),c("span",mt,"未啟用"))]),e("td",null,[e("div",null,[e("button",{type:"button",class:"text-#0d6efd bg-transparent border-1 border-#0d6efd border-solid rd-tl rd-bl px-2 py-1 hover:bg-#0d6efd hover:text-white hover:cursor-pointer",onClick:b=>E(l)}," 編輯 ",8,vt),e("button",{type:"button",class:"text-#dc3545 bg-transparent border-1 border-#de3545 border-solid rd-tr rd-br px-2 py-1 hover:bg-#de3545 hover:text-white hover:cursor-pointer",onClick:b=>r(l)}," 刪除 ",8,_t)])])]))),128))])])])]),n(tt,{onConfirmProduct:T,"temp-product":t.value,"is-new":p.value,ref_key:"dialog",ref:v},null,8,["temp-product","is-new"]),k.value.length?(u(),J(Q,{key:0,pages:d.value,onChangePage:h},null,8,["pages"])):q("",!0)],64))}};export{Vt as default};

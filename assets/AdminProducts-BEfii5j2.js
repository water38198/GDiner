import{a as U,S as f}from"./sweetalert2.all-BG_37rGc.js";import{L as N}from"./index-CegEb7TS.js";import{r as m,w as L,e as d,f as u,g as e,t as b,p as r,v as _,F as V,z as T,C as E,H as B,i as D,B as M,q as I,x as R,y as z,o as A,j as S,m as O,I as H}from"./index-BGcmftwk.js";import{_ as j}from"./plugin-vueexport-helper-DlAUqK2U.js";import{P as F}from"./PaginationComp-BHsoW4WD.js";var G={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payzoom",BASE_URL:"/GDiner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const i=h=>(R("data-v-310f7014"),h=h(),z(),h),J={method:"dialog"},K={class:"bg-primary p-4 flex justify-between items-center"},q={class:"text-white"},Q={class:"grid grid-cols-12 gap-6 p-3"},W={class:"col-span-4"},X={class:"input-group"},Y=i(()=>e("label",{for:"imagUrl",class:"block"},"主要圖片",-1)),Z=["src"],ee={action:"/api/thisismycourse2/admin/upload",enctype:"multipart/form-data",method:"post"},te=i(()=>e("img",{src:"",alt:""},null,-1)),oe=i(()=>e("h4",{class:"font-size-5 mb-4"},"多圖新增",-1)),se={class:"flex justify-between mb-2"},ae={for:"images-1"},ie=["onClick"],le={class:"input-group"},ne=["onUpdate:modelValue"],re=["src"],de={action:"/api/thisismycourse2/admin/upload",enctype:"multipart/form-data",method:"post",class:"mt-10"},ue={class:"col-span-8"},ce={class:"grid grid-cols-2 gap-col-6 gap-row-4"},pe={class:"input-group col-span-2"},ve=i(()=>e("label",{for:"title"},"名稱：",-1)),_e={class:"input-group"},me=i(()=>e("label",{for:"category"},"分類：",-1)),ge=I('<option value="主食" data-v-310f7014>主食</option><option value="沙拉" data-v-310f7014>沙拉</option><option value="湯品" data-v-310f7014>湯品</option><option value="副食" data-v-310f7014>副食</option><option value="甜點" data-v-310f7014>甜點</option><option value="飲料" data-v-310f7014>飲料</option><option value="套餐" data-v-310f7014>套餐</option>',7),fe=[ge],he={class:"input-group"},be=i(()=>e("label",{for:"unit"},"單位：",-1)),xe=I('<datalist id="units" data-v-310f7014><option value="碗" data-v-310f7014></option><option value="客" data-v-310f7014></option><option value="杯" data-v-310f7014></option><option value="份" data-v-310f7014></option><option value="個" data-v-310f7014></option></datalist>',1),ye={class:"input-group"},we=i(()=>e("label",{for:"origin_price"},"原價：",-1)),$e={class:"input-group"},Ue=i(()=>e("label",{for:"price"},"售價：",-1)),ke={class:"input-group"},Ce=i(()=>e("label",{for:"veggie"},"素食:",-1)),Ve=i(()=>e("option",{value:"true"},"是",-1)),Pe=i(()=>e("option",{value:"false"},"否",-1)),Te=[Ve,Pe],Ee={class:"input-group col-span-2"},Se=i(()=>e("label",{for:"tags"},"標籤：",-1)),De={class:"col-span-2"},Ie={key:0,class:"mb-4 flex"},Ne={class:"flex"},Le={class:"font-size-4 px-4"},Be=["onClick"],Me=i(()=>e("div",{class:"i-ic:baseline-close"},null,-1)),Re=[Me],ze={class:"input-group col-span-2"},Ae=i(()=>e("label",{for:"description"},"產品敘述",-1)),Oe={class:"input-group col-span-2"},He=i(()=>e("label",{for:"content"},"說明內容",-1)),je=i(()=>e("label",{for:"is_enabled"},"是否啟用",-1)),Fe={class:"text-end p-3 border-t border-solid border-#dee2e6"},Ge={__name:"ProductModal",props:["tempProduct","isNew"],setup(h,{expose:x}){const{VITE_URL:y,VITE_PATH:w}=G,v=h,o=m(v.tempProduct),c=m(),n=m("");function $(l){l.target.nodeName==="DIALOG"&&c.value.close()}function g(){o.value.imagesUrl||(o.value.imagesUrl=[]),o.value.imagesUrl[o.value.imagesUrl.length-1]!==""&&o.value.imagesUrl.push("")}function k(l,s){const t=s.target.files[0],a=new FormData;a.append("file-to-upload",t),U.post(`${y}/v2/api/${w}/admin/upload`,a).then(p=>{g(),l==="images"?o.value.imagesUrl[o.value.imagesUrl.length-1]=p.data.imageUrl:l==="image"&&(o.value.imageUrl=p.data.imageUrl)}).catch(p=>{console.log(p)})}function C(){if(n.value=="")return;o.value.tags||(o.value.tags=[]);const l=o.value.tags[o.value.tags.length-1]||"";n.value===l||l==null||(o.value.tags.push(n.value),n.value="")}function P(l){const s=o.value.tags.indexOf(l);o.value.tags.splice(s,1)}return L(()=>v.tempProduct,()=>{o.value=v.tempProduct}),x({dialog:c}),(l,s)=>(d(),u("dialog",{ref_key:"dialog",ref:c,class:"max-w-1140px w-100% border-0 rd p-0 backdrop:backdrop-blur-3",onClick:$},[e("form",J,[e("div",K,[e("h3",q,b(h.isNew?"新增產品":"編輯產品"),1),e("button",{type:"button",class:"i-ic:baseline-close p-2 text-white font-size-4 hover:cursor-pointer",onClick:s[0]||(s[0]=t=>c.value.close())})]),e("div",Q,[e("div",W,[e("div",X,[Y,r(e("input",{type:"text",placeholder:"請輸入圖片連結","onUpdate:modelValue":s[1]||(s[1]=t=>o.value.imageUrl=t),class:"mb-2"},null,512),[[_,o.value.imageUrl]]),e("img",{src:o.value.imageUrl,alt:""},null,8,Z)]),e("form",ee,[e("input",{type:"file",name:"file-to-upload",onChange:s[2]||(s[2]=t=>k("image",t))},null,32)]),te,e("div",null,[oe,(d(!0),u(V,null,T(o.value.imagesUrl,(t,a)=>(d(),u("div",{key:t,class:"mb-4"},[e("div",se,[e("label",ae,"圖片網址"+b(a+1),1),e("button",{class:"i-ic:baseline-close font-size-5 opacity-50 hover:cursor-pointer hover:opacity-75",onClick:p=>o.value.imagesUrl.splice(a,1)},null,8,ie)]),e("div",le,[r(e("input",{type:"text","onUpdate:modelValue":p=>o.value.imagesUrl[a]=p,placeholder:"請輸入圖片網址",class:",b-2"},null,8,ne),[[_,o.value.imagesUrl[a]]])]),e("img",{src:t,alt:""},null,8,re)]))),128)),e("button",{type:"button",class:"inline-block w-100% bg-transparent border-#0d6efd border-solid border-1 rd text-#0d6efd py-1 mb-1",hover:"cursor-pointer bg-#0d6efd text-white",onClick:g}," 新增圖片網址 "),e("form",de,[e("input",{type:"file",name:"file-to-upload",onChange:s[3]||(s[3]=t=>k("images",t))},null,32)])])]),e("div",ue,[e("div",ce,[e("div",pe,[ve,r(e("input",{type:"text",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":s[4]||(s[4]=t=>o.value.title=t)},null,512),[[_,o.value.title]])]),e("div",_e,[me,r(e("select",{id:"category","onUpdate:modelValue":s[5]||(s[5]=t=>o.value.category=t)},fe,512),[[E,o.value.category]])]),e("div",he,[be,r(e("input",{type:"text",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":s[6]||(s[6]=t=>o.value.unit=t),list:"units",autocomplete:"off"},null,512),[[_,o.value.unit]]),xe]),e("div",ye,[we,r(e("input",{type:"number",id:"origin_price",placeholder:"請輸入原價",min:"0","onUpdate:modelValue":s[7]||(s[7]=t=>o.value.origin_price=t)},null,512),[[_,o.value.origin_price,void 0,{number:!0}]])]),e("div",$e,[Ue,r(e("input",{type:"number",id:"price",placeholder:"請輸入售價",min:"0","onUpdate:modelValue":s[8]||(s[8]=t=>o.value.price=t)},null,512),[[_,o.value.price,void 0,{number:!0}]])]),e("div",ke,[Ce,r(e("select",{name:"",id:"veggie","onUpdate:modelValue":s[9]||(s[9]=t=>o.value.veggie=t)},Te,512),[[E,o.value.veggie]])]),e("div",Ee,[Se,r(e("input",{type:"text",id:"tags","onUpdate:modelValue":s[10]||(s[10]=t=>n.value=t),onKeydown:B(C,["enter"])},null,544),[[_,n.value,void 0,{trim:!0}]])]),e("div",De,[o.value.tags?(d(),u("div",Ie,[e("ul",Ne,[(d(!0),u(V,null,T(o.value.tags,(t,a)=>(d(),u("li",{key:`${a}+${t}`,class:"flex px-2 py-2 border-1 border-solid border-primary rd me-2"},[e("span",Le,b(t),1),e("a",{class:"border-0 bg-transparent p-0 hover:cursor-pointer",onClick:p=>P(t)},Re,8,Be)]))),128))])])):D("",!0),e("button",{type:"button",class:"border-0 rd bg-primary text-white px-4 py-2 hover:cursor-pointer hover:bg-primary-light",onClick:C},"新增標籤")]),e("div",ze,[Ae,r(e("textarea",{name:"",id:"description",rows:"6","onUpdate:modelValue":s[11]||(s[11]=t=>o.value.description=t)},null,512),[[_,o.value.description]])]),e("div",Oe,[He,r(e("textarea",{name:"",id:"content",rows:"4","onUpdate:modelValue":s[12]||(s[12]=t=>o.value.content=t)},null,512),[[_,o.value.content]])]),e("div",null,[r(e("input",{type:"checkbox",id:"is_enabled","onUpdate:modelValue":s[13]||(s[13]=t=>o.value.is_enabled=t),"true-value":1,"false-value":0},null,512),[[M,o.value.is_enabled]]),je])])])]),e("div",Fe,[e("button",{type:"button",class:"m-1 px-3 py-1.5 bg-transparent text-#6c757d border-1 border-solid border-#6c757d rd hover:cursor-pointer hover:bg-#5c636a hover:text-white",onClick:s[14]||(s[14]=t=>c.value.close())},"取消"),e("button",{type:"button",class:"m-1 px-3 py-1.5 text-white bg-#0d6efd border-0 rd hover:cursor-pointer hover:bg-#0b5ed7",onClick:s[15]||(s[15]=t=>l.$emit("confirmProduct",o.value))},"確定")])])],512))}},Je=j(Ge,[["__scopeId","data-v-310f7014"]]);var Ke={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payzoom",BASE_URL:"/GDiner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const qe={class:"p-10"},Qe=e("h2",{class:"font-size-12"},"產品",-1),We={class:"text-end mt-6"},Xe={class:"relative min-h-100"},Ye={class:"w-100% mt-6"},Ze=e("thead",{class:"border-b-1 border-black border-solid fw-bold text-left"},[e("tr",null,[e("th",{width:"120"}," 分類 "),e("th",null,"產品名稱"),e("th",{width:"120",class:"text-end"}," 原價 "),e("th",{width:"120",class:"text-end"}," 售價 "),e("th",{width:"100",class:"text-center"}," 是否啟用 "),e("th",{width:"120"}," 編輯 ")])],-1),et={class:"text-end"},tt={class:"text-end"},ot={class:"text-center"},st={key:0,class:"text-#198754"},at={key:1,class:"text-red"},it=["onClick"],lt=["onClick"],pt={__name:"AdminProducts",setup(h){const{VITE_URL:x,VITE_PATH:y}=Ke,w=m([]),v=m(),o=m({}),c=m(!0),n=m({}),$=m(!1);function g(s=1){$.value=!0,U.get(`${x}/v2/api/${y}/admin/products?page=${s}`).then(t=>{w.value=t.data.products,n.value=t.data.pagination}).catch(t=>{f.fire({icon:"error",title:"錯誤發生",text:t.response.data.message})}).finally(()=>{$.value=!1})}function k(){v.value.dialog.showModal(),o.value={},c.value=!0}function C(s){o.value=JSON.parse(JSON.stringify(s)),c.value=!1,v.value.dialog.showModal()}function P(s){if(c.value)s.created=Date.now(),U.post(`${x}/v2/api/${y}/admin/product`,{data:s}).then(t=>{f.fire({title:`${t.data.message}`,icon:"success",didClose:()=>{g(n.value.current_page||1)}}),v.value.dialog.close(),o.value={}}).catch(t=>{f.fire({icon:"error",title:"錯誤發生",text:`${t}`})});else{const{id:t}=s;U.put(`${x}/v2/api/${y}/admin/product/${t}`,{data:s}).then(a=>{f.fire({title:`${a.data.message}`,icon:"success",didClose:()=>{g(n.value.current_page||1)}}),v.value.dialog.close(),o.value={}}).catch(a=>{f.fire({icon:"error",title:"錯誤發生",text:`${a.response.data.message}`})})}}function l(s){f.fire({title:`你確定要刪除 ${s.title} 嗎?`,showCancelButton:!0,confirmButtonText:"確定",cancelButtonText:"取消"}).then(t=>{t.isConfirmed&&U.delete(`${x}/v2/api/${y}/admin/product/${s.id}`).then(a=>{f.fire({icon:"success",text:a.data.message,didClose:()=>{g(n.value.current_page||1)}})}).catch(a=>{f.fire({icon:"error",text:a.response.data.message})})})}return A(()=>{g()}),(s,t)=>(d(),u(V,null,[e("div",qe,[Qe,e("div",We,[e("button",{type:"button",class:"bg-primary border-0 text-white cursor-pointer inline-block px-3 py-1.5 rd font-size-4 hover:bg-primary-light",onClick:t[0]||(t[0]=a=>k())},"建立新的產品")]),e("div",Xe,[S(O(N),{active:$.value,"is-full-page":!1},null,8,["active"]),e("table",Ye,[Ze,e("tbody",null,[(d(!0),u(V,null,T(w.value,a=>(d(),u("tr",{class:"border-b border-#DEE2E6 border-solid",key:a.id},[e("td",null,b(a.category),1),e("td",null,b(a.title),1),e("td",et,b(a.origin_price),1),e("td",tt,b(a.price),1),e("td",ot,[a.is_enabled?(d(),u("span",st,"啟用")):(d(),u("span",at,"未啟用"))]),e("td",null,[e("div",null,[e("button",{type:"button",class:"text-#0d6efd bg-transparent border-1 border-#0d6efd border-solid rd-tl rd-bl px-2 py-1 hover:bg-#0d6efd hover:text-white hover:cursor-pointer",onClick:p=>C(a)}," 編輯 ",8,it),e("button",{type:"button",class:"text-#dc3545 bg-transparent border-1 border-#de3545 border-solid rd-tr rd-br px-2 py-1 hover:bg-#de3545 hover:text-white hover:cursor-pointer",onClick:p=>l(a)}," 刪除 ",8,lt)])])]))),128))])])])]),S(Je,{onConfirmProduct:P,"temp-product":o.value,"is-new":c.value,ref_key:"dialog",ref:v},null,8,["temp-product","is-new"]),w.value.length?(d(),H(F,{key:0,pages:n.value,onChangePage:g},null,8,["pages"])):D("",!0)],64))}};export{pt as default};

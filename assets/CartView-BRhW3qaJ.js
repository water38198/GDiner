import{_ as M,u as O,s as P,c as H,r as C,e as g,g as c,j as l,m as s,h as e,k as x,F as L,B as G,H as J,S as b,C as N,f as u,L as S,l as y,t as m,n as w,q as K,v as Q,p as W,z as X,A as Y}from"./index-p2KhtukQ.js";var Z={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payzoom",BASE_URL:"/GDiner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const n=h=>(X("data-v-e79e48a3"),h=h(),Y(),h),ee={class:"container px-2 md:px-12 py-10"},te={class:"mb-10"},se={key:0,"data-aos":"fade-up"},oe={class:"flex justify-between items-center pb-7.5"},ae=n(()=>e("h2",{class:"font-size-12"},"購物車",-1)),le={class:"mb-10 pb-10 border-b-1 border-solid border-primary-200"},ne={class:"block md:table w-100%"},re=n(()=>e("thead",{class:"block md:table-header-group w-100% mb-4 border-b-1 border-solid border-primary-veryLight text-primary-200"},[e("tr",{class:"flex md:table-row justify-between"},[e("th",{class:"text-left"},"料理"),e("th",{class:"md:w-50% lg:w-60%"}),e("th",{class:"hidden md:block text-start"},"數量"),e("th",{class:"text-right"},"小計")])],-1)),ie={class:"block md:table-row-group"},de={class:"md:pt-10 row-start-1 row-end-3 col-span-3"},ce={class:"w-100% h-30 me-2 md:w-25 lg:me-10"},ue=["src"],me={class:"md:pt-10 align-top col-start-4 col-end-10"},pe={class:"font-size-3.5 text-primary opacity-75 lh-150%"},_e={class:"md:pt-10 align-top col-start-4 col-end-10"},be={class:"md:mb-6 flex"},he={class:"relative grid grid-cols-3 w-40 customBorder rd-3 h-10 md:h-12.5"},fe=["onClick"],ve=n(()=>e("div",{class:"i-ic:round-minus"},null,-1)),ge=[ve],xe=["value","onChange"],ye=["onClick"],we=n(()=>e("div",{class:"i-ic:round-plus"},null,-1)),ke=[we],Ve={class:"flex ms-2"},Ce=["onClick"],ze=n(()=>e("div",{class:"i-material-symbols:delete-outline"},null,-1)),$e=[ze],Te={class:"row-start-1 row-end-3 col-start-10 col-end-13 md:pt-10 align-top text-end"},Ee={class:"pe-4 sm:ps-10 text-nowrap"},Be={class:"block md:table-row-group"},Fe={class:"block md:table-row"},Le={colspan:"4",class:"block md:table-cell w-100% pt-10 text-end"},Ne={class:"col-span-2 md:col-span-1 grid grid-cols-2 gap-4"},Se=n(()=>e("h2",{class:"col-span-2 mb-10 font-size-10"},"顧客資訊",-1)),De={class:"custom-input-group mb-4 col-span-2"},Ie=n(()=>e("label",{for:"email"},"Email",-1)),Ue={class:"custom-input-group mb-4 col-span-1 md:col-span-2"},qe=n(()=>e("label",{for:"姓名"},"姓名",-1)),Re={class:"custom-input-group mb-4 col-span-1 md:col-span-2"},je=n(()=>e("label",{for:"電話"},"電話",-1)),Ae={class:"custom-input-group mb-4 col-span-2"},Me=n(()=>e("label",{for:"地址"},"地址",-1)),Oe={class:"custom-input-group mb-4 col-span-2"},Pe=n(()=>e("label",{for:"message"},"留言(非必須)",-1)),He={class:"col-span-2 md:col-span-1"},Ge={class:"md:sticky top-22"},Je={class:"flex justify-center md:justify-end mb-10 font-size-5"},Ke=n(()=>e("h3",{class:"font-size-5 font-serif me-5"},"總計",-1)),Qe={key:0,class:"text-primary opacity-60"},We={key:1,class:"text-red-500"},Xe={class:"font-size-3 me-2"},Ye={class:"font-size-5 text-red-500"},Ze={class:"w-60% mx-auto md:ml-auto md:mr-0"},et={class:"custom-input-group mb-4"},tt=n(()=>e("label",{for:"coupon"},"優惠券",-1)),st={key:0,class:"mb-4"},ot={class:"mb-2"},at=n(()=>e("div",{class:"text-center md:text-end"},[e("button",{type:"submit",class:"max-w-60% w-100% h-12 p-x-7.5 p-y-1.5 bg-info text-secondary border-0 rd-10 cursor-pointer hover:shadow-[0_0_3px_0_#3D081B]"},"送出訂單")],-1)),lt={key:1,class:"pb-20"},nt=n(()=>e("h2",{class:"mb-7 font-size-8 md:font-size-12 lh-tight font-serif text-center"}," 目前購物車為空 (´⊙ω⊙`)",-1)),rt={class:"text-center"},it={__name:"CartView",setup(h){const{VITE_URL:z,VITE_PATH:$}=Z,T=O(),{cart:r,isLoading:D}=P(T),I=H(()=>{const i=[];return r.value.carts&&r.value.carts.forEach(o=>i.push(o.product.id)),i}),{getCart:E,updateCart:k,deleteCart:U,deleteCartAll:B}=T,f=C([]),d=C({user:{email:"",name:"",tel:"",address:""},message:""}),p=C("");function q(){if(r.value.carts.length===0){b.fire({icon:"error",title:"目前沒有東西在購物車喔~"});return}f.value.push("userForm"),N.post(`${z}/v2/api/${$}/order`,{data:d.value}).then(i=>{b.fire({title:i.data.message,icon:"success",text:`訂單號碼：${i.data.orderId}`,didClose:()=>{E()}})}).catch(i=>{b.fire({title:"錯誤發生",icon:"error",text:`${i.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`,confirmButtonColor:"#3D081B"})}).finally(()=>{f.value.splice(f.value.indexOf("userForm"),1)})}function R(){p.value&&N.post(`${z}/v2/api/${$}/coupon`,{data:{code:p.value}}).then(i=>{b.fire({icon:"success",title:`${i.data.message}`,toast:!0,position:"bottom-end",timer:1500,showConfirmButton:!1}),p.value="",E()}).catch(i=>{b.fire({icon:"error",title:`${i.response.data.message}`})})}function j(i){return/^(09)[0-9]{8}$/.test(i)?!0:"請輸入正確的電話號碼"}return(i,o)=>{var F;const V=g("RouterLink"),_=g("VField"),v=g("ErrorMessage"),A=g("VForm");return u(),c(L,null,[l(s(S),{active:s(D)},null,8,["active"]),e("div",ee,[e("div",te,[((F=s(r).carts)==null?void 0:F.length)>0?(u(),c("div",se,[e("div",oe,[ae,l(V,{to:"/products",class:"tracking-widest underline underline-offset-4 hover:decoration-2"},{default:x(()=>[y(" 繼續購物 ")]),_:1})]),e("div",le,[e("table",ne,[re,e("tbody",ie,[(u(!0),c(L,null,G(s(r).carts,t=>(u(),c("tr",{key:t.id+"123",class:"grid gap-2 grid-rows-[repeat(2,auto)] grid-cols-[repeat(12,1fr)] md:table-row w-100% mb-6"},[e("td",de,[e("div",ce,[e("img",{src:t.product.imageUrl,alt:"",class:"block max-w-25 w-100% h-100% border-2 border-solid border-primary rd-2.5"},null,8,ue)])]),e("td",me,[e("div",null,[l(V,{to:`/product/${t.product.id}`,class:"block mb-2 lh-normal hover:underline hover:underline-offset-4 hover:decoration-2"},{default:x(()=>[y(m(t.product.title),1)]),_:2},1032,["to"]),e("div",null,[e("span",pe," NT$"+m(t.product.price),1)])])]),e("td",_e,[e("div",be,[e("div",he,[e("button",{class:"block bg-transparent border-0 px-4 cursor-pointer font-size-5 fw-900",onClick:a=>{t.qty-1>0&&t.qty--,s(k)(t)}},ge,8,fe),e("input",{type:"number",name:"",id:"quantity",value:t.qty,class:"block bg-transparent border-0 appearance-none outline-0 w-100% text-center font-size-4",min:"1",onChange:a=>s(k)(t,a)},null,40,xe),e("button",{class:"block bg-transparent border-0 px-4 cursor-pointer font-size-5 fw-900",onClick:a=>{t.qty++,s(k)(t)}},ke,8,ye)]),e("div",Ve,[e("button",{type:"button",class:"bg-transparent border-0 font-size-5 cursor-pointer px-0",onClick:a=>s(U)(t.id)},$e,8,Ce)])])]),e("td",Te,[e("span",Ee,"NT$ "+m(t.final_total),1)])]))),128))]),e("tfoot",Be,[e("tr",Fe,[e("td",Le,[e("button",{type:"button",class:"bg-transparent border-0 underline underline-offset-4 cursor-pointer hover:text-primary-light",onClick:o[0]||(o[0]=(...t)=>s(B)&&s(B)(...t))},"清空購物車")])])])])]),e("div",null,[l(s(S),{active:f.value.includes("userForm")},null,8,["active"]),l(A,{class:"grid grid-cols-2 gap-4",onSubmit:q,autocomplete:"off"},{default:x(({errors:t})=>[e("div",Ne,[Se,e("div",De,[l(_,{type:"email",name:"email",id:"email",class:w({invalid:t.email}),placeholder:"請輸入 Email",rules:"required|email",modelValue:d.value.user.email,"onUpdate:modelValue":o[1]||(o[1]=a=>d.value.user.email=a)},null,8,["class","modelValue"]),Ie,l(v,{name:"email",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",Ue,[l(_,{type:"text",name:"姓名",id:"name",class:w({invalid:t.姓名}),rules:"required",placeholder:"請輸入 姓名",modelValue:d.value.user.name,"onUpdate:modelValue":o[2]||(o[2]=a=>d.value.user.name=a)},null,8,["class","modelValue"]),qe,l(v,{name:"姓名",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",Re,[l(_,{type:"tel",name:"電話",id:"tel",class:w({invalid:t.電話}),rules:j,placeholder:"請輸入 電話",modelValue:d.value.user.tel,"onUpdate:modelValue":o[3]||(o[3]=a=>d.value.user.tel=a)},null,8,["class","modelValue"]),je,l(v,{name:"電話",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",Ae,[l(_,{type:"address",name:"地址",id:"address",class:w({invalid:t.地址}),rules:"required",placeholder:"請輸入 地址",modelValue:d.value.user.address,"onUpdate:modelValue":o[4]||(o[4]=a=>d.value.user.address=a)},null,8,["class","modelValue"]),Me,l(v,{name:"地址",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",Oe,[l(_,{as:"textarea",name:"userForm.message",id:"message",cols:"30",rows:"10",modelValue:d.value.message,"onUpdate:modelValue":o[5]||(o[5]=a=>d.value.message=a),placeholder:"請輸入留言"},null,8,["modelValue"]),Pe])]),e("div",He,[e("div",Ge,[e("div",Je,[Ke,s(r).total===s(r).final_total?(u(),c("p",Qe,[y("NT$ "),e("span",null,m(s(r).final_total),1)])):(u(),c("p",We,[e("del",Xe,"NT$"+m(s(r).total),1),e("span",Ye,"NT$"+m(s(r).final_total),1)]))]),e("div",Ze,[e("div",et,[K(e("input",{type:"text",name:"coupon",id:"coupon",class:"block w-100% p-x-3 p-y-1.5 border-1 border-solid border-#dee2e6 rd",placeholder:"請輸入 優惠券","onUpdate:modelValue":o[6]||(o[6]=a=>p.value=a)},null,512),[[Q,p.value,void 0,{trim:!0}]]),tt,e("button",{type:"button",class:"absolute right-0 top-50% translate-y--50% block h-100% border-0 bg-transparent p-x-3 p-y-1.5 border-l-2 border-solid border-primary rd-r-3 cursor-pointer hover:bg-primary hover:text-secondary",onClick:R},"使用")]),s(r).carts[0].coupon?(u(),c("div",st,[e("p",ot,"已套用優惠券代碼："+m(s(r).carts[0].coupon.code),1),e("p",null,"折扣金額： -"+m(s(r).total-s(r).final_total),1)])):W("",!0)]),at])])]),_:1})])])):(u(),c("div",lt,[nt,e("div",rt,[l(V,{to:"/products",class:"inline-block bg-info text-secondary tracking-widest px-5 py-3 rd-100vh shadow-[0_2px_0_0_#3D081B] hover:shadow-[0_1px_0_0_#3D081B]"},{default:x(()=>[y(" 趕緊購物去 ")]),_:1})])]))]),l(J,{exclude:I.value},null,8,["exclude"])])],64)}}},ct=M(it,[["__scopeId","data-v-e79e48a3"]]);export{ct as default};

import{_ as m,o as n,c as a,b as s,t as u,F as f,j as w,p as v,i as x,e as p,d as h,w as k,g as b,r as g}from"./index-Cd9JHZzw.js";import{P as V}from"./PaginationComponent-BJryJdVF.js";const S={props:{modelValue:Array},data(){return{categories:["主食","沙拉","湯品","副食","甜點","飲料","套餐"]}},computed:{selectedCount(){return this.modelValue.length}},methods:{updateCategory(e){let t=[...this.modelValue];e.target.checked?t.push(e.target.value):t=t.filter(l=>l!==e.target.value),this.$emit("update:modelValue",t)},resetCategory(){this.$emit("update:modelValue",[])}}},P=e=>(v("data-v-c953783e"),e=e(),x(),e),R={class:"dropdown"},B=P(()=>s("button",{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[p("分類 "),s("i",{class:"bi bi-caret-down-fill"})],-1)),F={class:"dropdown-menu bg-secondary custom-border"},I={class:"dropdown-header d-flex justify-content-between px-5 py-2"},E=P(()=>s("hr",{class:"dropdown-divider"},null,-1)),q={class:"list-unstyled pt-4"},N={class:"form-check fs-5"},U=["id","value","checked"],j=["for"];function A(e,t,l,y,o,i){return n(),a("div",R,[B,s("div",F,[s("div",I,[s("span",null,u(i.selectedCount)+" 已選取",1),s("button",{type:"button",class:"text-decoration-underline text-offset-4",onClick:t[0]||(t[0]=(...r)=>i.resetCategory&&i.resetCategory(...r))}," 重置 ")]),E,s("ul",q,[(n(!0),a(f,null,w(o.categories,r=>(n(),a("li",{key:r,class:"px-4 mb-2"},[s("div",N,[s("input",{class:"form-check-input fs-5 border-2 border-primary",type:"checkbox",id:r,value:r,checked:l.modelValue.includes(r),onChange:t[1]||(t[1]=(...d)=>i.updateCategory&&i.updateCategory(...d))},null,40,U),s("label",{class:"form-check-label",for:r},u(r),9,j)])]))),128))])])])}const D=m(S,[["render",A],["__scopeId","data-v-c953783e"]]),H={props:{high:{type:[Number,String]},low:{type:[Number,String]}},emits:["update:high","update:low"],methods:{resetPriceRange(){this.$emit("update:high",null),this.$emit("update:low",null)},changeLow(e){this.$emit("update:low",e.target.value)},changeHigh(e){this.$emit("update:high",e.target.value)}}},_=e=>(v("data-v-4bf4f27d"),e=e(),x(),e),O={class:"dropdown"},M=_(()=>s("button",{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[p("價格"),s("i",{class:"bi bi-caret-down-fill"})],-1)),z={class:"dropdown-menu dropdown-menu-start bg-secondary custom-border"},G={class:"dropdown-header d-flex justify-content-between px-5 py-2"},J=_(()=>s("span",{class:"fs-5"},"價格範圍",-1)),K=_(()=>s("hr",{class:"dropdown-divider"},null,-1)),Q={action:"",class:"d-flex align-items-center p-4"},W=_(()=>s("span",{class:"fs-md-4 fs-lg-3 me-1"},"$",-1)),X={class:"form-floating me-4"},Y=["value"],Z=_(()=>s("label",{for:"lowPrice"},"最低價",-1)),ee=_(()=>s("span",{class:"fs-md-4 fs-lg-3 me-1"},"$",-1)),te={class:"form-floating"},se=["value"],ie=_(()=>s("label",{for:"highPrice"},"最高價",-1));function re(e,t,l,y,o,i){return n(),a("div",O,[M,s("div",z,[s("div",G,[J,s("button",{type:"button",class:"text-decoration-underline text-offset-4",onClick:t[0]||(t[0]=(...r)=>i.resetPriceRange&&i.resetPriceRange(...r))}," 重置 ")]),K,s("form",Q,[W,s("div",X,[s("input",{type:"number",id:"lowPrice",onChange:t[1]||(t[1]=(...r)=>i.changeLow&&i.changeLow(...r)),value:l.low,class:"form-control custom-border bg-secondary fs-7 fs-md-6",placeholder:"最低價",min:"0"},null,40,Y),Z]),ee,s("div",te,[s("input",{type:"number",id:"highPrice",onChange:t[2]||(t[2]=(...r)=>i.changeHigh&&i.changeHigh(...r)),value:l.high,class:"form-control custom-border bg-secondary fs-7 fs-md-6",placeholder:"最高價",min:"0"},null,40,se),ie])])])])}const oe=m(H,[["render",re],["__scopeId","data-v-4bf4f27d"]]),le={props:["modelValue"],emits:["update:modelValue"],data(){return{sorts:["最高價格","最低價格","最新","最舊"]}},methods:{changeSort(e){this.$emit("update:modelValue",e.target.value)}}},ne=["value","selected"];function ae(e,t,l,y,o,i){return n(),a("div",null,[s("select",{name:"sortBy",id:"sortBy",onChange:t[0]||(t[0]=(...r)=>i.changeSort&&i.changeSort(...r)),class:"bg-transparent border-0",ref:"sortRef"},[(n(!0),a(f,null,w(o.sorts,r=>(n(),a("option",{key:r,value:r,selected:r==="最新"},u(r),9,ne))),128))],544)])}const ce=m(le,[["render",ae],["__scopeId","data-v-f41261f3"]]),de={props:{filteredList:{type:Array,default:()=>[]},pages:{type:Object,required:!0},isLoading:{type:Boolean,default:!1}},computed:{isEmptyList(){return this.filteredList.length===0&&!this.isLoading}}},ue=e=>(v("data-v-a9cd32f8"),e=e(),x(),e),he={class:"mb-12"},ge={key:0,class:"list-unstyled row row-cols-2 row-cols-md-3 row-cols-lg-4 gy-4"},pe={class:"card"},_e={class:"card-image"},fe=["src","alt"],me={class:"fs-5 card-title"},ye={class:"pb-4"},be={key:0},we={key:1},ve={class:"text-danger me-2"},xe={class:"text-gray-400 fs-7"},Pe={key:1},$e=ue(()=>s("h3",{class:"pt-10 fs-4 text-center"},[p("很抱歉，沒有符合條件的商品。"),s("br"),p("(〒︿〒)")],-1)),Ce=[$e];function Le(e,t,l,y,o,i){const r=g("RouterLink");return n(),a("div",he,[l.filteredList.length>0?(n(),a("ul",ge,[(n(!0),a(f,null,w(l.filteredList.slice(12*(l.pages.current_page-1),12*l.pages.current_page),d=>(n(),a("li",{key:d.id,"data-aos":"fade-up","data-aos-delay":500,"data-aos-offset":"0"},[s("div",pe,[h(r,{to:`/product/${d.id}`,class:"block"},{default:k(()=>[s("div",_e,[s("img",{src:d.imageUrl,alt:`${d.title}的圖片`},null,8,fe)]),s("h3",me,u(d.title),1),s("div",ye,[d.price==d.origin_price?(n(),a("div",be,[s("span",null,"NT$ "+u(d.price),1)])):(n(),a("div",we,[s("span",ve,"NT$ "+u(d.price),1),s("del",xe,"NT$ "+u(d.origin_price),1)]))])]),_:2},1032,["to"])])]))),128))])):i.isEmptyList?(n(),a("div",Pe,Ce)):b("",!0)])}const Te=m(de,[["render",Le],["__scopeId","data-v-a9cd32f8"]]);var ke={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payzoom",BASE_URL:"/GDiner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:Ve,VITE_PATH:Se}=ke,Re={components:{CategoryFilter:D,PriceFilter:oe,SortFilter:ce,ProductsList:Te,PaginationComponent:V},data(){return{isLoading:!1,products:[],sortBy:"最新",filterCategories:[],lowPrice:null,highPrice:null,priceRangeText:"",searchText:"",pages:{current_page:1,total_pages:0}}},computed:{filteredList(){let e=[];return this.filterCategories.length>0?e=this.products.filter(t=>this.filterCategories.includes(t.category)):e=this.products,this.lowPrice>0&&(e=e.filter(t=>t.price>=this.lowPrice)),this.highPrice>0&&(e=e.filter(t=>t.price<=this.highPrice)),this.sortBy==="最新"&&(e=e.sort((t,l)=>l.created-t.created)),this.sortBy==="最舊"&&(e=e.sort((t,l)=>t.created-l.created)),this.sortBy==="最高價格"&&(e=e.sort((t,l)=>l.price-t.price)),this.sortBy==="最低價格"&&(e=e.sort((t,l)=>t.price-l.price)),this.searchText&&(e=e.filter(t=>t.title.includes(this.searchText))),e},isEmptySelected(){return this.filterCategories.length!==0||this.priceRangeText!==""||this.searchText!==""}},methods:{async getProducts(){this.isLoading=!0;try{const e=await this.$http.get(`${Ve}/v2/api/${Se}/products/all`);this.products=e.data.products}catch(e){this.$swal({title:"錯誤發生",icon:"error",text:`${e.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`})}finally{this.isLoading=!1}},deleteCategory(e){this.filterCategories=this.filterCategories.filter(t=>t!==e)},resetSearch(){this.searchText=""},resetFilter(){this.filterCategories=[],this.lowPrice=null,this.highPrice=null,this.resetSearch()},changePage(e){typeof e=="number"?this.pages.current_page=e:e==="+"?this.pages.current_page++:this.pages.current_page--,window.scrollTo({top:0})},getPriceText(){let e=this.lowPrice,t=this.highPrice;(e==null||e==null)&&(e=""),(t==null||t==null)&&(t=""),e==""&&t==""?this.priceRangeText="":this.priceRangeText=`${e} ~ ${t}`}},watch:{"$route.query.search"(){this.$route.query.search&&(this.searchText=this.$route.query.search)},filteredList(){this.pages.total_pages=Math.ceil(this.filteredList.length/12),this.pages.current_page=1},lowPrice(){this.getPriceText()},highPrice(){this.getPriceText()}},mounted(){this.$route.query.category&&this.filterCategories.push(this.$route.query.category),this.$route.query.sort&&(this.sortBy=this.$route.query.sort),this.$route.query.search&&(this.searchText=this.$route.query.search),this.getProducts()}},Be={class:"container min-vh-100"},Fe=s("h2",{class:"py-6 fs-1"},"料理",-1),Ie={class:"d-flex align-items-center justify-content-between mb-6"},Ee={class:"d-flex items-center gap-2"},qe={class:"ms-auto"},Ne={key:0,class:"d-flex gap-2 mb-6"},Ue=["onClick"],je=s("div",{class:"i-material-symbols:close"},null,-1),Ae=s("div",{class:"i-material-symbols:close"},null,-1),De=s("div",{class:"i-material-symbols:close"},null,-1);function He(e,t,l,y,o,i){const r=g("VLoading"),d=g("CategoryFilter"),$=g("PriceFilter"),C=g("SortFilter"),L=g("ProductsList"),T=g("PaginationComponent");return n(),a(f,null,[h(r,{active:o.isLoading},null,8,["active"]),s("div",Be,[Fe,s("div",Ie,[s("form",Ee,[h(d,{modelValue:o.filterCategories,"onUpdate:modelValue":t[0]||(t[0]=c=>o.filterCategories=c)},null,8,["modelValue"]),h($,{high:o.highPrice,"onUpdate:high":t[1]||(t[1]=c=>o.highPrice=c),low:o.lowPrice,"onUpdate:low":t[2]||(t[2]=c=>o.lowPrice=c)},null,8,["high","low"]),h(C,{modelValue:o.sortBy,"onUpdate:modelValue":t[3]||(t[3]=c=>o.sortBy=c)},null,8,["modelValue"])]),s("span",qe,u(i.filteredList.length)+" 項料理",1)]),i.isEmptySelected?(n(),a("div",Ne,[(n(!0),a(f,null,w(o.filterCategories,c=>(n(),a("button",{type:"button",class:"d-flex align-items-center btn btn-outline-primary border-2 rounded-pill fs-7",key:c,onClick:Oe=>i.deleteCategory(c)},[p(u(c)+" ",1),je],8,Ue))),128)),o.priceRangeText!==""?(n(),a("button",{key:0,type:"button",class:"d-flex align-items-center btn btn-outline-primary border-2 rounded-pill fs-7",onClick:t[4]||(t[4]=(...c)=>e.resetPriceRange&&e.resetPriceRange(...c))},[p(u(o.priceRangeText)+" ",1),Ae])):b("",!0),o.searchText!==""?(n(),a("button",{key:1,type:"button",class:"d-flex align-items-center btn btn-outline-primary border-2 rounded-pill fs-7",onClick:t[5]||(t[5]=(...c)=>i.resetSearch&&i.resetSearch(...c))},[p(" 搜尋："+u(o.searchText)+" ",1),De])):b("",!0),s("button",{type:"button",onClick:t[6]||(t[6]=(...c)=>i.resetFilter&&i.resetFilter(...c)),class:"bg-transparent text-decoration-underline text-offset-4 )"}," 清除全部 ")])):b("",!0),h(L,{pages:o.pages,"filtered-list":i.filteredList,"is-loading":o.isLoading},null,8,["pages","filtered-list","is-loading"]),h(T,{pages:o.pages,onChangePage:i.changePage},null,8,["pages","onChangePage"])])],64)}const Ge=m(Re,[["render",He]]);export{Ge as default};

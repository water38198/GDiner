import{_ as F,R as z,m as L,a as E,c as i,b as e,F as B,l as T,d as r,e as _,g as $,v as R,t as c,i as S,f as b,u as y,r as u,o as d,n as f,p as D,k as N}from"./index-JINe9Ytb.js";var U={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payzoom",BASE_URL:"/GDiner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:w,VITE_PATH:x}=U,I={components:{RandomProduct:z},data(){return{isLoading:!1,userForm:{user:{email:"",name:"",tel:"",address:""},message:""},coupon:""}},computed:{...L(y,["cart","cartLoading"]),excludeList(){const t=[];return this.cart.carts&&this.cart.carts.forEach(o=>t.push(o.product.id)),t}},methods:{...E(y,["getCart","updateCart","deleteCart","deleteCartAll"]),async submitOrder(){if(this.cart.carts.length===0){this.$swal({icon:"error",title:"目前沒有東西在購物車喔~"});return}try{this.isLoading=!0;const t=await this.$http.post(`${w}/v2/api/${x}/order`,{data:this.userForm});this.$swal({title:t.data.message,icon:"success",timer:3e3,showConfirmButton:!1}).then(()=>{this.getCart(),this.$router.push(`order?id=${t.data.orderId}`)})}catch(t){this.$swal({title:"錯誤發生",icon:"error",text:`${t.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`,confirmButtonColor:"#3D081B"})}finally{this.isLoading=!1}},async useCoupon(){if(this.coupon)try{const t=await this.$http.post(`${w}/v2/api/${x}/coupon`,{data:{code:this.coupon}});this.$swal({icon:"success",title:`${t.data.message}`,toast:!0,position:"bottom-end",timer:1500,showConfirmButton:!1}),this.coupon="",this.getCart()}catch(t){this.$swal({icon:"error",title:`${t.response.data.message}`})}},isPhone(t){return/^(09)[0-9]{8}$/.test(t)?!0:"請輸入正確的電話號碼"}}},l=t=>(D("data-v-3a704bf8"),t=t(),N(),t),q={class:"container px-2 md:px-12 py-10"},P={class:"mb-10"},A={key:0,"data-aos":"fade-up"},M={class:"flex justify-between items-center pb-7.5"},j=l(()=>e("h2",{class:"font-size-12"},"購物車",-1)),O={class:"mb-10 pb-10 border-b-1 border-solid border-primary-200"},H={class:"block md:table w-100%"},G=l(()=>e("thead",{class:"block md:table-header-group w-100% mb-4 border-b-1 border-solid border-primary-veryLight text-primary-200"},[e("tr",{class:"flex md:table-row justify-between"},[e("th",{class:"text-left"},"料理"),e("th",{class:"md:w-50% lg:w-60%"}),e("th",{class:"hidden md:block text-start"},"數量"),e("th",{class:"text-right"},"小計"),e("th",{class:"hidden md:block"})])],-1)),J={class:"block md:table-row-group border-b-1 border-solid border-primary-200"},K={class:"md:py-5 row-start-1 row-end-3 col-span-3"},Q={class:"w-100% h-30 me-2 md:w-25 lg:me-10"},W=["src","alt"],X={class:"md:py-5 align-top col-start-4 col-end-10"},Y={class:"font-size-3.5 text-primary opacity-75 lh-150%"},Z={class:"md:py-5 align-top col-start-4 col-end-10"},ee={class:"md:mb-6 flex"},te={class:"relative grid grid-cols-3 w-40 customBorder rd-3 h-10 md:h-12.5"},se=["onClick"],oe=l(()=>e("div",{class:"i-ic:round-minus"},null,-1)),re=[oe],le=["value","onChange"],ae=["onClick"],ne=l(()=>e("div",{class:"i-ic:round-plus"},null,-1)),ie=[ne],de={class:"row-start-1 row-end-2 col-start-10 col-end-13 ps-10 md:py-5 flex justify-end md:table-cell align-top"},ce={class:"flex justify-end items-start md:items-center h-12.5 text-nowrap"},ue={class:"col-start-10 col-end-13 md:table-cell align-top md:py-5"},me={class:"mx-4 flex justify-end h-12.5"},pe=["onClick"],he=l(()=>e("div",{class:"i-material-symbols:delete-outline"},null,-1)),_e=[he],be={class:"block md:table-row-group"},fe={class:"block md:table-row mb-10"},ge={colspan:"5",class:"block md:table-cell w-100% pt-10 text-center md:text-start"},ve={class:"block md:table-row"},ye={colspan:"5",class:"block md:table-cell w-100%"},we={class:"w-70 ms-a"},xe={class:"custom-input-group mb-4"},ke=l(()=>e("label",{for:"coupon"},"優惠券",-1)),Ce={key:0,class:"mb-4 text-end"},Ve={class:"mb-2"},Fe={class:"flex items-center justify-end font-size-5"},ze=l(()=>e("h3",{class:"me-5"},"總計",-1)),Le={key:0,class:"text-primary"},Ee={key:1,class:"text-red-500 font-size-6"},Be={class:"grid grid-cols-2 gap-4"},Te=l(()=>e("h2",{class:"col-span-2 mb-10 font-size-10"},"顧客資訊",-1)),$e={class:"custom-input-group mb-4 col-span-2"},Re=l(()=>e("label",{for:"email"},"Email",-1)),Se={class:"custom-input-group mb-4"},De=l(()=>e("label",{for:"姓名"},"姓名",-1)),Ne={class:"custom-input-group mb-4"},Ue=l(()=>e("label",{for:"電話"},"電話",-1)),Ie={class:"custom-input-group mb-4 col-span-2"},qe=l(()=>e("label",{for:"地址"},"地址",-1)),Pe={class:"custom-input-group mb-4 col-span-2"},Ae=l(()=>e("label",{for:"message"},"留言(非必須)",-1)),Me=l(()=>e("div",{class:"col-span-2 text-center"},[e("button",{type:"submit",class:"max-w-50% w-100% h-12 p-x-7.5 p-y-1.5 bg-info shadow-[0_2px_0_0_#3D081B] text-secondary border-0 rd-10 cursor-pointer hover:shadow-none hover:bg-info-dark"},"送出訂單")],-1)),je={key:1,class:"pb-20"},Oe=l(()=>e("h2",{class:"mb-7 font-size-8 md:font-size-12 lh-tight font-serif text-center"}," 目前購物車為空 (´⊙ω⊙`)",-1)),He={class:"text-center"};function Ge(t,o,Je,Ke,n,m){var v;const g=u("RouterLink"),k=u("VLoading"),p=u("VField"),h=u("ErrorMessage"),C=u("VForm"),V=u("RandomProduct");return d(),i("div",q,[e("div",P,[((v=t.cart.carts)==null?void 0:v.length)>0?(d(),i("div",A,[e("div",M,[j,e("button",{type:"button",class:"bg-transparent border-0 underline underline-offset-4 cursor-pointer hover:text-primary-light",onClick:o[0]||(o[0]=(...s)=>t.deleteCartAll&&t.deleteCartAll(...s))},"清空購物車")]),e("div",O,[e("table",H,[G,e("tbody",J,[(d(!0),i(B,null,T(t.cart.carts,s=>(d(),i("tr",{key:s.id+"123",class:"grid gap-2 grid-rows-[repeat(2,auto)] grid-cols-[repeat(12,1fr)] md:table-row w-100% mb-6"},[e("td",K,[e("div",Q,[e("img",{src:s.product.imageUrl,alt:`${s.product.title}的照片`,class:"block max-w-25 w-100% h-100% border-2 border-solid border-primary rd-2.5"},null,8,W)])]),e("td",X,[e("div",null,[r(g,{to:`/product/${s.product.id}`,class:"block mb-2 lh-normal hover:underline hover:underline-offset-4 hover:decoration-2"},{default:_(()=>[b(c(s.product.title),1)]),_:2},1032,["to"]),e("div",null,[e("span",Y," NT$"+c(s.product.price),1)])])]),e("td",Z,[e("div",ee,[e("div",te,[e("button",{type:"button",class:"block bg-transparent border-0 px-4 cursor-pointer font-size-5 fw-900",onClick:a=>{s.qty-1>0&&s.qty--,t.updateCart(s)}},re,8,se),e("input",{type:"number",name:"",id:"quantity",value:s.qty,class:"block bg-transparent border-0 appearance-none outline-0 w-100% text-center font-size-4",min:"1",onChange:a=>t.updateCart(s,a)},null,40,le),e("button",{type:"button",class:"block bg-transparent border-0 px-4 cursor-pointer font-size-5 fw-900",onClick:a=>{s.qty++,t.updateCart(s)}},ie,8,ae)])])]),e("td",de,[e("span",ce,"NT$ "+c(Math.floor(s.final_total)),1)]),e("td",ue,[e("div",me,[e("button",{type:"button",class:"bg-transparent border-0 font-size-6 cursor-pointer px-0 hover:opacity-60",onClick:a=>t.deleteCart(s.id)},_e,8,pe)])])]))),128))]),e("tfoot",be,[e("tr",fe,[e("td",ge,[r(g,{to:"/products",class:"tracking-widest underline underline-offset-4 hover:decoration-2"},{default:_(()=>[b(" 繼續購物 ")]),_:1})])]),e("tr",ve,[e("td",ye,[e("div",we,[e("div",xe,[$(e("input",{type:"text",name:"coupon",id:"coupon",class:"block w-100% p-x-3 p-y-1.5 border-1 border-solid border-#dee2e6 rd",placeholder:"請輸入 優惠券","onUpdate:modelValue":o[1]||(o[1]=s=>n.coupon=s)},null,512),[[R,n.coupon,void 0,{trim:!0}]]),ke,e("button",{type:"button",class:"absolute right-0 top-50% translate-y--50% block h-100% border-0 bg-transparent p-x-3 p-y-1.5 border-l-2 border-solid border-primary rd-r-3 cursor-pointer hover:bg-primary hover:text-secondary",onClick:o[2]||(o[2]=(...s)=>m.useCoupon&&m.useCoupon(...s))},"使用")]),t.cart.carts[0].coupon?(d(),i("div",Ce,[e("p",Ve,"已套用優惠券代碼："+c(t.cart.carts[0].coupon.code),1),e("p",null,"折扣金額： -"+c(Math.floor(t.cart.total-t.cart.final_total)),1)])):S("",!0)]),e("div",null,[e("div",Fe,[ze,t.cart.total==t.cart.final_total?(d(),i("p",Le,[b("NT$ "),e("span",null,c(t.cart.total),1)])):(d(),i("p",Ee,"NT$"+c(Math.floor(t.cart.final_total)),1))])])])])])])]),e("div",null,[r(k,{active:n.isLoading},null,8,["active"]),r(C,{class:"md:w-75% mx-auto",onSubmit:m.submitOrder,autocomplete:"off"},{default:_(({errors:s})=>[e("div",Be,[Te,e("div",$e,[r(p,{type:"email",name:"email",id:"email",class:f({invalid:s.email}),placeholder:"請輸入 Email",rules:"required|email",modelValue:n.userForm.user.email,"onUpdate:modelValue":o[3]||(o[3]=a=>n.userForm.user.email=a)},null,8,["class","modelValue"]),Re,r(h,{name:"email",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",Se,[r(p,{type:"text",name:"姓名",id:"name",class:f({invalid:s.姓名}),rules:"required",placeholder:"請輸入 姓名",modelValue:n.userForm.user.name,"onUpdate:modelValue":o[4]||(o[4]=a=>n.userForm.user.name=a)},null,8,["class","modelValue"]),De,r(h,{name:"姓名",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",Ne,[r(p,{type:"tel",name:"電話",id:"tel",class:f({invalid:s.電話}),rules:m.isPhone,placeholder:"請輸入 電話",modelValue:n.userForm.user.tel,"onUpdate:modelValue":o[5]||(o[5]=a=>n.userForm.user.tel=a)},null,8,["class","rules","modelValue"]),Ue,r(h,{name:"電話",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",Ie,[r(p,{type:"address",name:"地址",id:"address",class:f({invalid:s.地址}),rules:"required",placeholder:"請輸入 地址",modelValue:n.userForm.user.address,"onUpdate:modelValue":o[6]||(o[6]=a=>n.userForm.user.address=a)},null,8,["class","modelValue"]),qe,r(h,{name:"地址",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",Pe,[r(p,{as:"textarea",name:"userForm.message",id:"message",cols:"30",rows:"10",modelValue:n.userForm.message,"onUpdate:modelValue":o[7]||(o[7]=a=>n.userForm.message=a),placeholder:"請輸入留言"},null,8,["modelValue"]),Ae]),Me])]),_:1},8,["onSubmit"])])])):(d(),i("div",je,[Oe,e("div",He,[r(g,{to:"/products",class:"inline-block bg-info text-secondary tracking-widest px-5 py-3 rd-100vh shadow-[0_2px_0_0_#3D081B] hover:shadow-[0_1px_0_0_#3D081B]"},{default:_(()=>[b(" 趕緊購物去 ")]),_:1})])]))]),r(V,{exclude:m.excludeList},null,8,["exclude"])])}const We=F(I,[["render",Ge],["__scopeId","data-v-3a704bf8"]]);export{We as default};

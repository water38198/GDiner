import{_ as O,u as P,s as H,b as G,r as C,c as J,e as g,g as c,j as l,q as s,h as e,F as L,B as K,k as x,m as Q,v as W,t as m,x as X,l as y,H as Y,S as b,C as S,f as u,L as D,n as w,z as Z,A as ee}from"./index-BrG9BiK3.js";var te={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payzoom",BASE_URL:"/GDiner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const a=h=>(Z("data-v-c4ff6326"),h=h(),ee(),h),se={class:"container px-2 md:px-12 py-10"},oe={class:"mb-10"},le={key:0,"data-aos":"fade-up"},ae={class:"flex justify-between items-center pb-7.5"},ne=a(()=>e("h2",{class:"font-size-12"},"購物車",-1)),re={class:"mb-10 pb-10 border-b-1 border-solid border-primary-200"},ie={class:"block md:table w-100%"},de=a(()=>e("thead",{class:"block md:table-header-group w-100% mb-4 border-b-1 border-solid border-primary-veryLight text-primary-200"},[e("tr",{class:"flex md:table-row justify-between"},[e("th",{class:"text-left"},"料理"),e("th",{class:"md:w-50% lg:w-60%"}),e("th",{class:"hidden md:block text-start"},"數量"),e("th",{class:"text-right"},"小計"),e("th",{class:"hidden md:block"})])],-1)),ce={class:"block md:table-row-group border-b-1 border-solid border-primary-200"},ue={class:"md:py-5 row-start-1 row-end-3 col-span-3"},me={class:"w-100% h-30 me-2 md:w-25 lg:me-10"},pe=["src","alt"],_e={class:"md:py-5 align-top col-start-4 col-end-10"},be={class:"font-size-3.5 text-primary opacity-75 lh-150%"},he={class:"md:py-5 align-top col-start-4 col-end-10"},fe={class:"md:mb-6 flex"},ve={class:"relative grid grid-cols-3 w-40 customBorder rd-3 h-10 md:h-12.5"},ge=["onClick"],xe=a(()=>e("div",{class:"i-ic:round-minus"},null,-1)),ye=[xe],we=["value","onChange"],ke=["onClick"],Ve=a(()=>e("div",{class:"i-ic:round-plus"},null,-1)),Ce=[Ve],$e={class:"row-start-1 row-end-2 col-start-10 col-end-13 ps-10 md:py-5 flex justify-end md:table-cell align-top"},ze={class:"flex justify-end items-start md:items-center h-12.5 text-nowrap"},Be={class:"col-start-10 col-end-13 md:table-cell align-top md:py-5"},Ee={class:"mx-4 flex justify-end h-12.5"},Te=["onClick"],Fe=a(()=>e("div",{class:"i-material-symbols:delete-outline"},null,-1)),Le=[Fe],Se={class:"block md:table-row-group"},De={class:"block md:table-row mb-10"},Ie={colspan:"5",class:"block md:table-cell w-100% pt-10 text-center md:text-start"},Ne={class:"block md:table-row"},Ue={colspan:"5",class:"block md:table-cell w-100%"},qe={class:"w-70 ms-a"},Re={class:"custom-input-group mb-4"},je=a(()=>e("label",{for:"coupon"},"優惠券",-1)),Me={key:0,class:"mb-4 text-end"},Ae={class:"mb-2"},Oe={class:"flex items-center justify-end font-size-5"},Pe=a(()=>e("h3",{class:"me-5"},"總計",-1)),He={key:0,class:"text-primary"},Ge={key:1,class:"text-red-500 font-size-6"},Je={class:"grid grid-cols-2 gap-4"},Ke=a(()=>e("h2",{class:"col-span-2 mb-10 font-size-10"},"顧客資訊",-1)),Qe={class:"custom-input-group mb-4 col-span-2"},We=a(()=>e("label",{for:"email"},"Email",-1)),Xe={class:"custom-input-group mb-4"},Ye=a(()=>e("label",{for:"姓名"},"姓名",-1)),Ze={class:"custom-input-group mb-4"},et=a(()=>e("label",{for:"電話"},"電話",-1)),tt={class:"custom-input-group mb-4 col-span-2"},st=a(()=>e("label",{for:"地址"},"地址",-1)),ot={class:"custom-input-group mb-4 col-span-2"},lt=a(()=>e("label",{for:"message"},"留言(非必須)",-1)),at=a(()=>e("div",{class:"col-span-2 text-center"},[e("button",{type:"submit",class:"max-w-50% w-100% h-12 p-x-7.5 p-y-1.5 bg-info shadow-[0_2px_0_0_#3D081B] text-secondary border-0 rd-10 cursor-pointer hover:shadow-none hover:bg-info-dark"},"送出訂單")],-1)),nt={key:1,class:"pb-20"},rt=a(()=>e("h2",{class:"mb-7 font-size-8 md:font-size-12 lh-tight font-serif text-center"}," 目前購物車為空 (´⊙ω⊙`)",-1)),it={class:"text-center"},dt={__name:"CartView",setup(h){const{VITE_URL:$,VITE_PATH:z}=te,B=P(),{cart:i,isLoading:I}=H(B),N=G(),{getCart:E,updateCart:k,deleteCart:U,deleteCartAll:T}=B,f=C([]),d=C({user:{email:"",name:"",tel:"",address:""},message:""}),p=C("");function q(){if(i.value.carts.length===0){b.fire({icon:"error",title:"目前沒有東西在購物車喔~"});return}f.value.push("userForm"),S.post(`${$}/v2/api/${z}/order`,{data:d.value}).then(n=>{b.fire({title:n.data.message,icon:"success",timer:1500,showConfirmButton:!1}).then(()=>{E(),N.push(`order?id=${n.data.orderId}`)})}).catch(n=>{b.fire({title:"錯誤發生",icon:"error",text:`${n.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`,confirmButtonColor:"#3D081B"})}).finally(()=>{f.value.splice(f.value.indexOf("userForm"),1)})}function R(){p.value&&S.post(`${$}/v2/api/${z}/coupon`,{data:{code:p.value}}).then(n=>{b.fire({icon:"success",title:`${n.data.message}`,toast:!0,position:"bottom-end",timer:1500,showConfirmButton:!1}),p.value="",E()}).catch(n=>{b.fire({icon:"error",title:`${n.response.data.message}`})})}function j(n){return/^(09)[0-9]{8}$/.test(n)?!0:"請輸入正確的電話號碼"}const M=J(()=>{const n=[];return i.value.carts&&i.value.carts.forEach(o=>n.push(o.product.id)),n});return(n,o)=>{var F;const V=g("RouterLink"),_=g("VField"),v=g("ErrorMessage"),A=g("VForm");return u(),c(L,null,[l(s(D),{active:s(I)},null,8,["active"]),e("div",se,[e("div",oe,[((F=s(i).carts)==null?void 0:F.length)>0?(u(),c("div",le,[e("div",ae,[ne,e("button",{type:"button",class:"bg-transparent border-0 underline underline-offset-4 cursor-pointer hover:text-primary-light",onClick:o[0]||(o[0]=(...t)=>s(T)&&s(T)(...t))},"清空購物車")]),e("div",re,[e("table",ie,[de,e("tbody",ce,[(u(!0),c(L,null,K(s(i).carts,t=>(u(),c("tr",{key:t.id+"123",class:"grid gap-2 grid-rows-[repeat(2,auto)] grid-cols-[repeat(12,1fr)] md:table-row w-100% mb-6"},[e("td",ue,[e("div",me,[e("img",{src:t.product.imageUrl,alt:`${t.product.title}的照片`,class:"block max-w-25 w-100% h-100% border-2 border-solid border-primary rd-2.5"},null,8,pe)])]),e("td",_e,[e("div",null,[l(V,{to:`/product/${t.product.id}`,class:"block mb-2 lh-normal hover:underline hover:underline-offset-4 hover:decoration-2"},{default:x(()=>[y(m(t.product.title),1)]),_:2},1032,["to"]),e("div",null,[e("span",be," NT$"+m(t.product.price),1)])])]),e("td",he,[e("div",fe,[e("div",ve,[e("button",{type:"button",class:"block bg-transparent border-0 px-4 cursor-pointer font-size-5 fw-900",onClick:r=>{t.qty-1>0&&t.qty--,s(k)(t)}},ye,8,ge),e("input",{type:"number",name:"",id:"quantity",value:t.qty,class:"block bg-transparent border-0 appearance-none outline-0 w-100% text-center font-size-4",min:"1",onChange:r=>s(k)(t,r)},null,40,we),e("button",{type:"button",class:"block bg-transparent border-0 px-4 cursor-pointer font-size-5 fw-900",onClick:r=>{t.qty++,s(k)(t)}},Ce,8,ke)])])]),e("td",$e,[e("span",ze,"NT$ "+m(Math.floor(t.final_total)),1)]),e("td",Be,[e("div",Ee,[e("button",{type:"button",class:"bg-transparent border-0 font-size-6 cursor-pointer px-0 hover:opacity-60",onClick:r=>s(U)(t.id)},Le,8,Te)])])]))),128))]),e("tfoot",Se,[e("tr",De,[e("td",Ie,[l(V,{to:"/products",class:"tracking-widest underline underline-offset-4 hover:decoration-2"},{default:x(()=>[y(" 繼續購物 ")]),_:1})])]),e("tr",Ne,[e("td",Ue,[e("div",qe,[e("div",Re,[Q(e("input",{type:"text",name:"coupon",id:"coupon",class:"block w-100% p-x-3 p-y-1.5 border-1 border-solid border-#dee2e6 rd",placeholder:"請輸入 優惠券","onUpdate:modelValue":o[1]||(o[1]=t=>p.value=t)},null,512),[[W,p.value,void 0,{trim:!0}]]),je,e("button",{type:"button",class:"absolute right-0 top-50% translate-y--50% block h-100% border-0 bg-transparent p-x-3 p-y-1.5 border-l-2 border-solid border-primary rd-r-3 cursor-pointer hover:bg-primary hover:text-secondary",onClick:R},"使用")]),s(i).carts[0].coupon?(u(),c("div",Me,[e("p",Ae,"已套用優惠券代碼："+m(s(i).carts[0].coupon.code),1),e("p",null,"折扣金額： -"+m(Math.floor(s(i).total-s(i).final_total)),1)])):X("",!0)]),e("div",null,[e("div",Oe,[Pe,s(i).total==s(i).final_total?(u(),c("p",He,[y("NT$ "),e("span",null,m(s(i).total),1)])):(u(),c("p",Ge,"NT$"+m(Math.floor(s(i).final_total)),1))])])])])])])]),e("div",null,[l(s(D),{active:f.value.includes("userForm")},null,8,["active"]),l(A,{class:"md:w-75% mx-auto",onSubmit:q,autocomplete:"off"},{default:x(({errors:t})=>[e("div",Je,[Ke,e("div",Qe,[l(_,{type:"email",name:"email",id:"email",class:w({invalid:t.email}),placeholder:"請輸入 Email",rules:"required|email",modelValue:d.value.user.email,"onUpdate:modelValue":o[2]||(o[2]=r=>d.value.user.email=r)},null,8,["class","modelValue"]),We,l(v,{name:"email",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",Xe,[l(_,{type:"text",name:"姓名",id:"name",class:w({invalid:t.姓名}),rules:"required",placeholder:"請輸入 姓名",modelValue:d.value.user.name,"onUpdate:modelValue":o[3]||(o[3]=r=>d.value.user.name=r)},null,8,["class","modelValue"]),Ye,l(v,{name:"姓名",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",Ze,[l(_,{type:"tel",name:"電話",id:"tel",class:w({invalid:t.電話}),rules:j,placeholder:"請輸入 電話",modelValue:d.value.user.tel,"onUpdate:modelValue":o[4]||(o[4]=r=>d.value.user.tel=r)},null,8,["class","modelValue"]),et,l(v,{name:"電話",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",tt,[l(_,{type:"address",name:"地址",id:"address",class:w({invalid:t.地址}),rules:"required",placeholder:"請輸入 地址",modelValue:d.value.user.address,"onUpdate:modelValue":o[5]||(o[5]=r=>d.value.user.address=r)},null,8,["class","modelValue"]),st,l(v,{name:"地址",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",ot,[l(_,{as:"textarea",name:"userForm.message",id:"message",cols:"30",rows:"10",modelValue:d.value.message,"onUpdate:modelValue":o[6]||(o[6]=r=>d.value.message=r),placeholder:"請輸入留言"},null,8,["modelValue"]),lt]),at])]),_:1})])])):(u(),c("div",nt,[rt,e("div",it,[l(V,{to:"/products",class:"inline-block bg-info text-secondary tracking-widest px-5 py-3 rd-100vh shadow-[0_2px_0_0_#3D081B] hover:shadow-[0_1px_0_0_#3D081B]"},{default:x(()=>[y(" 趕緊購物去 ")]),_:1})])]))]),l(Y,{exclude:M.value},null,8,["exclude"])])],64)}}},ut=O(dt,[["__scopeId","data-v-c4ff6326"]]);export{ut as default};

import{_ as E,j as x,s as R,f as g,o as m,c as p,b as a,u as n,a as e,F as C,g as T,t as h,k,v as B,r as V,l as L,m as D,w as S,n as $,p as F,q as U,h as M,S as q,d as N,R as j}from"./index-DuHCPTtL.js";const P={class:"position-relative"},A={class:"d-flex justify-content-between align-items-center"},O={class:"table align-middle"},z={class:"table-group-divider border-bottom border-primary"},H={class:"product-image"},G=["src","alt"],Q={class:"product-info"},J={class:"d-flex flex-column justify-content-between"},K={class:"fs-5 fs-md-3"},W={class:"text-info"},X={class:"text-primary text-opacity-75"},Y={class:"product-qty"},Z={class:"d-flex align-items-center gap-2"},I={class:"position-relative border-custom"},ee=["disabled","onClick"],te=["onUpdate:modelValue","onChange","disabled"],se=["disabled","onClick"],oe=["onClick"],le={class:"product-total text-end"},ae={__name:"CartTable",setup(w){const s=x(),{cart:d,cartLoading:c}=R(s),{clearCart:i,deleteCartItem:_,updateCartItem:v}=x(),b=(t,l)=>{let u=parseInt(l.target.value)<1||isNaN(parseInt(l.target.value))?1:parseInt(l.target.value);v(t,u)};return(t,l)=>{const u=g("VLoading");return m(),p("div",P,[a(u,{active:n(c),"is-full-page":!1},null,8,["active"]),e("div",A,[l[1]||(l[1]=e("h2",{class:"fw-bold"},"購物車",-1)),e("button",{type:"button",class:"bg-transparent border-0 text-decoration-underline",onClick:l[0]||(l[0]=(...o)=>n(i)&&n(i)(...o))},"清空購物車")]),e("table",O,[l[3]||(l[3]=e("thead",{class:"thead"},[e("tr",null,[e("th",null,"商品"),e("th",{class:"d-none d-md-table-cell"}),e("th",{class:"d-none d-md-table-cell"},"數量"),e("th",{class:"text-end"},"小計")])],-1)),e("tbody",z,[(m(!0),p(C,null,T(n(d).carts,o=>(m(),p("tr",{key:o.id,class:"product-row"},[e("td",H,[e("img",{src:o.product.imageUrl,alt:`${o.product.title}的照片`,class:"border border-primary"},null,8,G)]),e("td",Q,[e("div",J,[e("h3",K,h(o.product.title),1),e("span",W,h(o.product.category),1),e("span",X,"$"+h(o.product.price),1)])]),e("td",Y,[e("div",Z,[e("div",I,[e("button",{type:"button",class:"position-absolute h-100 start-0 border-0 bg-transparent ps-4",disabled:n(c),onClick:f=>n(v)(o,o.qty-1)},"-",8,ee),k(e("input",{type:"number",name:"qty",id:"qty","onUpdate:modelValue":f=>o.qty=f,onChange:f=>b(o,f),class:"bg-secondary rounded",disabled:n(c)},null,40,te),[[B,o.qty]]),e("button",{type:"button",class:"position-absolute h-100 end-0 border-0 bg-transparent pe-4",disabled:n(c),onClick:f=>n(v)(o,o.qty+1)},"+",8,se)]),e("button",{class:"btn btn-primary",onClick:f=>n(_)(o)},l[2]||(l[2]=[e("i",{class:"bi bi-trash3"},null,-1)]),8,oe)])]),e("td",le," $"+h(o.final_total),1)]))),128))])])])}}},ne=E(ae,[["__scopeId","data-v-9e848d74"]]),re={class:"position-relative"},ie={class:"coupon mb-8"},de={class:"text-end"},ce={key:0,class:"text-end"},ue={class:"text-danger"},me={class:"pb-4 text-end"},pe={__name:"CartCoupon",setup(w){const s=x(),d=V(""),c=V(!1),i=()=>{c.value=!c.value},_=V(!1),v=async b=>{_.value=!0,await s.submitCoupon(b),_.value=!1};return(b,t)=>{const l=g("VLoading"),u=g("VField"),o=g("ErrorMessage"),f=g("VForm");return m(),p(C,null,[e("div",re,[a(l,{active:_.value,"is-full-page":!1},null,8,["active"]),e("div",ie,[k(e("p",de,[e("a",{class:"text-decoration-underline link-opacity-75-hover",href:"#",onClick:D(i,["prevent"])},"優惠券")],512),[[L,!c.value]]),k(e("div",null,[a(f,{onSubmit:t[1]||(t[1]=y=>v(d.value)),autocomplete:"off",class:"d-flex gap-2 justify-content-end"},{default:S(({errors:y})=>[e("div",null,[a(u,{type:"text",class:$(["form-control border-custom",{"is-invalid":y.優惠券}]),name:"優惠券",id:"優惠券",rules:"required",placeholder:"請輸入優惠券代碼",modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=r=>d.value=r)},null,8,["class","modelValue"]),a(o,{name:"優惠券",class:"invalid-feedback"})]),t[2]||(t[2]=e("button",{class:"btn btn-outline-primary text-nowrap",type:"submit"},"使用",-1))]),_:1})],512),[[L,c.value]])]),n(s).cart.carts[0].coupon?(m(),p("div",ce,[e("p",null,"已套用優惠券："+h(n(s).cart.carts[0].coupon.code),1),e("p",ue,"折扣金額： "+h(n(s).cart.final_total-n(s).cart.total),1)])):F("",!0),e("h3",me,"總計：$ "+h(n(s).cart.final_total),1)]),t[3]||(t[3]=e("hr",null,null,-1))],64)}}},_e=E(pe,[["__scopeId","data-v-cff9f3df"]]),ve={BASE_URL:"/GDiner/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_PATH:"payzoom",VITE_URL:"https://vue3-course-api.hexschool.io"},fe={class:"position-relative container"},be={class:"container"},ge={class:"mb-8 row gy-8"},ye={class:"col-12 col-md-8"},he={class:"row gy-8"},Ve={class:"col-12"},$e={class:"form-floating"},xe={class:"col-6"},ke={class:"form-floating"},Ce={class:"col-6"},we={class:"form-floating"},Ee={class:"col-12"},Se={class:"form-floating"},Fe={class:"col-12 col-md-4"},Le={class:"border-custom p-4 fs-5"},Ue={class:"form-check"},qe={class:"form-check"},Re={key:0,class:"mt-4"},Te={class:"form-floating"},Be={id:"list"},De=["value"],Me={__name:"CartForm",setup(w){const s=V({user:{email:"",name:"",tel:"",address:"阿橘飯店",type:"內用",seat_number:""},message:""}),d=V(null),c=b=>/^(09)[0-9]{8}$/.test(b)?!0:"請輸入正確的電話號碼",i=V(!1),_=x(),v=async()=>{const{VITE_URL:b,VITE_PATH:t}=ve;try{i.value=!0;const l=await M.post(`${b}/v2/api/${t}/order`,{data:s.value});d.value.resetForm(),q.fire({icon:"success",title:`${l.data.message}`,text:`感謝您的訂購，訂單號碼： ${l.data.orderId}`,confirmButtonColor:"#3D081B"})}catch(l){q.fire({icon:"error",title:"錯誤",text:`${l.response.data.message}`,confirmButtonColor:"#3D081B"})}finally{i.value=!1,_.getCart()}};return(b,t)=>{const l=g("VLoading"),u=g("VField"),o=g("ErrorMessage"),f=g("VForm");return m(),p("div",fe,[a(l,{active:i.value,"is-full-page":!1},null,8,["active"]),a(f,{onSubmit:v,autocomplete:"off",ref_key:"formRef",ref:d},{default:S(({errors:y})=>[e("div",be,[e("div",ge,[e("div",ye,[t[11]||(t[11]=e("h3",{class:"mb-8 fw-bold"},"顧客資訊",-1)),e("div",he,[e("div",Ve,[e("div",$e,[a(u,{type:"email",name:"Email",id:"email",class:$(["form-control border-custom",{"is-invalid":y.Email}]),placeholder:"請輸入 Email",rules:"required|email",modelValue:s.value.user.email,"onUpdate:modelValue":t[0]||(t[0]=r=>s.value.user.email=r)},null,8,["class","modelValue"]),t[7]||(t[7]=e("label",{for:"email"},"Email",-1)),a(o,{name:"Email",class:"invalid-feedback"})])]),e("div",xe,[e("div",ke,[a(u,{type:"text",name:"姓名",id:"name",class:$(["form-control border-custom",{"is-invalid":y.姓名}]),rules:"required",placeholder:"請輸入 姓名",modelValue:s.value.user.name,"onUpdate:modelValue":t[1]||(t[1]=r=>s.value.user.name=r)},null,8,["class","modelValue"]),t[8]||(t[8]=e("label",{for:"姓名"},"姓名",-1)),a(o,{name:"姓名",class:"invalid-feedback"})])]),e("div",Ce,[e("div",we,[a(u,{type:"tel",name:"電話",id:"tel",class:$(["form-control border-custom",{"is-invalid":y.電話}]),rules:c,placeholder:"請輸入 電話",modelValue:s.value.user.tel,"onUpdate:modelValue":t[2]||(t[2]=r=>s.value.user.tel=r)},null,8,["class","modelValue"]),t[9]||(t[9]=e("label",{for:"tel"},"電話",-1)),a(o,{name:"電話",class:"invalid-feedback"})])]),e("div",Ee,[e("div",Se,[a(u,{as:"textarea",name:"userForm.message",id:"message",cols:"30",rows:"10",class:"form-control border-custom",modelValue:s.value.message,"onUpdate:modelValue":t[3]||(t[3]=r=>s.value.message=r),placeholder:"請輸入留言"},null,8,["modelValue"]),t[10]||(t[10]=e("label",{for:"message"},"備註",-1))])])])]),e("div",Fe,[t[15]||(t[15]=e("h3",{class:"mb-8 fw-bold"},"用餐方式",-1)),e("div",Le,[e("div",Ue,[k(e("input",{class:"form-check-input",type:"radio",name:"type",id:"here",value:"內用",checked:"","onUpdate:modelValue":t[4]||(t[4]=r=>s.value.user.type=r)},null,512),[[U,s.value.user.type]]),t[12]||(t[12]=e("label",{class:"form-check-label",for:"here"},"內用",-1))]),e("div",qe,[k(e("input",{class:"form-check-input",type:"radio",name:"type",id:"to_go",value:"外帶","onUpdate:modelValue":t[5]||(t[5]=r=>s.value.user.type=r)},null,512),[[U,s.value.user.type]]),t[13]||(t[13]=e("label",{class:"form-check-label",for:"to_go"},"外帶",-1))])]),s.value.user.type==="內用"?(m(),p("div",Re,[e("div",Te,[a(u,{type:"number",name:"座位號碼",id:"seat_number",class:$(["form-control border-custom",{"is-invalid":y.座位號碼}]),placeholder:"請輸入座位號碼",list:"list",modelValue:s.value.user.seat_number,"onUpdate:modelValue":t[6]||(t[6]=r=>s.value.user.seat_number=r),rules:"required"},null,8,["class","modelValue"]),t[14]||(t[14]=e("label",{for:"seat_number"},"座位號碼",-1)),a(o,{name:"座位號碼",class:"invalid-feedback"}),e("datalist",Be,[(m(),p(C,null,T(10,r=>e("option",{key:r,value:r},null,8,De)),64))])])])):F("",!0)])])]),t[16]||(t[16]=e("div",null,[e("div",{class:"text-center"},[e("button",{type:"submit",class:"btn btn-primary btn-lg"},"結帳")])],-1))]),_:1},512)])}}},Ne=E(Me,[["__scopeId","data-v-fc8576da"]]),je={class:"position-relative container py-8 min-vh-75"},Pe={key:1,class:"text-center h-75"},Oe={__name:"CartView",setup(w){const s=x(),{cart:d}=R(s);return(c,i)=>{var _,v;return m(),p("div",je,[((_=n(d).carts)==null?void 0:_.length)>0?(m(),p(C,{key:0},[a(ne),a(_e),a(Ne)],64)):n(d).carts&&((v=n(d).carts)==null?void 0:v.length)===0?(m(),p("div",Pe,[i[1]||(i[1]=e("h2",{class:"mb-8 text-center"},"目前購物車為空 (´⊙ω⊙`)",-1)),a(n(j),{to:"/products",class:"btn btn-info px-5 py-3"},{default:S(()=>i[0]||(i[0]=[N("趕緊購物去")])),_:1})])):F("",!0)])}}};export{Oe as default};

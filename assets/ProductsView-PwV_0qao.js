import{_ as m,o as l,c as a,b as s,t as u,F as f,l as v,f as _,p as w,k as $,d as h,e as V,i as p,r as g,w as P,n as R}from"./index-JINe9Ytb.js";const S={props:{modelValue:Array},data(){return{categories:["主食","沙拉","湯品","副食","甜點","飲料","套餐"]}},computed:{selectedCount(){return this.modelValue.length}},methods:{updateCategory(t){let e=[...this.modelValue];t.target.checked?e.push(t.target.value):e=e.filter(i=>i!==t.target.value),this.$emit("update:modelValue",e)},resetCategory(){this.$emit("update:modelValue",[])}}},B={class:"relative"},z=s("summary",{class:"flex list-none text-primary-light cursor-pointer hover:underline hover:underline-offset-4"},[s("span",{class:"text-primary-light hover:text-primary"},"分類"),s("div",{class:"i-material-symbols:keyboard-arrow-down"})],-1),F={class:"absolute top-10 left-[-40px] sm:left-[-1.2rem] z-2 w-80 rd-4 customBorder rd-2 bg-secondary"},q={class:"flex justify-between px-5 py-4 border-b-1 border-solid border-primary-200"},I={class:"px-5 py-1"},N=["for"],E=["id","value","checked"];function U(t,e,i,b,n,o){return l(),a("details",B,[z,s("div",F,[s("div",q,[s("span",null,u(o.selectedCount)+" 已選取",1),s("button",{type:"button",class:"bg-transparent border-0 underline underline-offset-4 tracking-widest hover:cursor-pointer hover:decoration-2",onClick:e[0]||(e[0]=(...r)=>o.resetCategory&&o.resetCategory(...r))}," 重置 ")]),s("ul",I,[(l(!0),a(f,null,v(n.categories,r=>(l(),a("li",{key:r},[s("label",{for:r,class:"relative flex gap-3 py-2.5 lh-tight cursor-pointer"},[s("input",{type:"checkbox",id:r,value:r,checked:i.modelValue.includes(r),onChange:e[1]||(e[1]=(...d)=>o.updateCategory&&o.updateCategory(...d)),class:"appearance-none m-0 size-5 rd-1 cursor-pointer"},null,40,E),_(" "+u(r),1)],8,N)]))),128))])])])}const j=m(S,[["render",U]]),A={props:{high:{type:[Number,String]},low:{type:[Number,String]}},emits:["update:high","update:low"],methods:{resetPriceRange(){this.$emit("update:high",null),this.$emit("update:low",null)},changeLow(t){this.$emit("update:low",t.target.value)},changeHigh(t){this.$emit("update:high",t.target.value)}}},y=t=>(w("data-v-1fd942f0"),t=t(),$(),t),D={class:"relative"},H=y(()=>s("summary",{class:"flex list-none text-primary-light hover:cursor-pointer hover:underline hover:underline-offset-4"},[s("span",{class:"text-primary-light hover:text-primary"},"價格"),s("div",{class:"i-material-symbols:keyboard-arrow-down"})],-1)),O={class:"absolute top-10 left-[-120px] sm:left-[-1.2rem] z-2 w-80 rd-4 customBorder rd-2 bg-secondary"},M={class:"flex justify-between px-5 py-4 border-b-1 border-solid border-primary-200"},G=y(()=>s("span",null,"價格範圍",-1)),J={class:"flex items-center p-5"},K=y(()=>s("span",{class:"me-1"},"$",-1)),Q={class:"price-group"},W=["value"],X=y(()=>s("label",{for:"lowPrice"},"最低價",-1)),Y=y(()=>s("span",{class:"ms-5 me-1"},"$",-1)),Z={class:"price-group"},ee=["value"],te=y(()=>s("label",{for:"highPrice"},"最高價",-1));function se(t,e,i,b,n,o){return l(),a("details",D,[H,s("div",O,[s("div",M,[G,s("button",{type:"button",class:"bg-transparent border-0 underline underline-offset-4 tracking-widest hover:cursor-pointer hover:decoration-2",onClick:e[0]||(e[0]=(...r)=>o.resetPriceRange&&o.resetPriceRange(...r))}," 重置 ")]),s("div",J,[K,s("div",Q,[s("input",{type:"number",id:"lowPrice",onChange:e[1]||(e[1]=(...r)=>o.changeLow&&o.changeLow(...r)),value:i.low,class:"w-100%",placeholder:"最低價",min:"0"},null,40,W),X]),Y,s("div",Z,[s("input",{type:"number",id:"highPrice",onChange:e[2]||(e[2]=(...r)=>o.changeHigh&&o.changeHigh(...r)),value:i.high,class:"w-100%",placeholder:"最高價",min:"0"},null,40,ee),te])])])])}const re=m(A,[["render",se],["__scopeId","data-v-1fd942f0"]]),ie={props:["modelValue"],emits:["update:modelValue"],data(){return{sorts:["最高價格","最低價格","最新","最舊"]}},methods:{changeSort(t){this.$emit("update:modelValue",t.target.value)}}},oe=["value","selected"];function ne(t,e,i,b,n,o){return l(),a("div",null,[s("select",{name:"sortBy",id:"sortBy",onChange:e[0]||(e[0]=(...r)=>o.changeSort&&o.changeSort(...r)),class:"bg-transparent border-0 cursor-pointer font-size-4",ref:"sortRef"},[(l(!0),a(f,null,v(n.sorts,r=>(l(),a("option",{key:r,value:r,selected:r==="最新"},u(r),9,oe))),128))],544)])}const le=m(ie,[["render",ne]]),ae={props:{filteredList:{type:Array,default(){return[]}},pages:{type:Object,required:!0},isLoading:{type:Boolean}}},ce={class:"relative min-h-100 mb-12",ref:"productsListRef"},de={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},ue={class:"card"},he={class:"card-image"},ge=["src","alt"],pe={class:"mb-4 tracking-wider"},_e={class:"pb-4"},fe={key:0},me={key:1},ye={class:"text-red me-2"},be={class:"text-gray-400 font-size-3"},ve={key:1},xe=s("h3",{class:"pt-10 font-size-6 text-center"},[_("很抱歉，沒有符合條件的商品。"),s("br"),_("(〒︿〒)")],-1),Pe=[xe];function we(t,e,i,b,n,o){const r=g("RouterLink");return l(),a("div",ce,[i.filteredList.length>0?(l(),a("ul",de,[(l(!0),a(f,null,v(i.filteredList.slice(12*(i.pages.current-1),12*i.pages.current),d=>(l(),a("li",{key:d.id,"data-aos":"fade-up","data-aos-delay":500,"data-aos-offset":"0"},[s("div",ue,[h(r,{to:`/product/${d.id}`,class:"block"},{default:V(()=>[s("div",he,[s("img",{src:d.imageUrl,alt:`${d.title}的圖片`,class:"block w-100% h-150px sm:h-350px md:h-300px"},null,8,ge)]),s("h3",pe,u(d.title),1),s("div",_e,[d.price==d.origin_price?(l(),a("div",fe,[s("span",null,"NT$ "+u(d.price),1)])):(l(),a("div",me,[s("span",ye,"NT$ "+u(d.price),1),s("del",be,"NT$ "+u(d.origin_price),1)]))])]),_:2},1032,["to"])])]))),128))])):i.filteredList.length===0&&!i.isLoading?(l(),a("div",ve,Pe)):p("",!0)],512)}const $e=m(ae,[["render",we]]),ke={props:{pages:{type:Object,required:!0}},emits:{changePage:null},methods:{changePage(t){this.$emit("changePage",t)}}},Ce={key:0,class:"mb-12"},Le={role:"navigation","aria-label":"Pagination"},Te={class:"flex justify-center font-size-5 fw-bold"},Ve={key:0},Re=s("div",{class:"i-ic:round-keyboard-arrow-left"},null,-1),Se=[Re],Be=["onClick"],ze={key:1},Fe=s("div",{class:"i-ic:round-keyboard-arrow-right"},null,-1),qe=[Fe];function Ie(t,e,i,b,n,o){return i.pages.total>1?(l(),a("div",Ce,[s("nav",Le,[s("ul",Te,[i.pages.current!==1?(l(),a("li",Ve,[s("a",{href:"#",class:"block px-2 fw-400",onClick:e[0]||(e[0]=P(r=>o.changePage("-"),["prevent"]))},Se)])):p("",!0),(l(!0),a(f,null,v(i.pages.total,r=>(l(),a("li",{key:`${r}+123`,class:R({"underline underline-offset-6 decoration-2 pointer-events-none":r==i.pages.current})},[s("a",{href:"#",class:"block px-4",onClick:P(d=>o.changePage(r),["prevent"])},u(r),9,Be)],2))),128)),i.pages.current!==i.pages.total?(l(),a("li",ze,[s("a",{href:"#",class:"block px-2 fw-400",onClick:e[1]||(e[1]=P(r=>o.changePage("+"),["prevent"]))},qe)])):p("",!0)])])])):p("",!0)}const Ne=m(ke,[["render",Ie]]);var Ee={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payzoom",BASE_URL:"/GDiner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:Ue,VITE_PATH:je}=Ee,Ae={components:{CategoryFilter:j,PriceFilter:re,SortFilter:le,ProductsList:$e,ProductsPagination:Ne},data(){return{isLoading:!1,products:[],sortBy:"最新",filterCategories:[],lowPrice:null,highPrice:null,priceRangeText:"",searchText:"",pages:{current:1,total:0}}},computed:{filteredList(){let t=[];return this.filterCategories.length>0?t=this.products.filter(e=>this.filterCategories.includes(e.category)):t=this.products,this.lowPrice>0&&(t=t.filter(e=>e.price>=this.lowPrice)),this.highPrice>0&&(t=t.filter(e=>e.price<=this.highPrice)),this.sortBy==="最新"&&(t=t.sort((e,i)=>i.created-e.created)),this.sortBy==="最舊"&&(t=t.sort((e,i)=>e.created-i.created)),this.sortBy==="最高價格"&&(t=t.sort((e,i)=>i.price-e.price)),this.sortBy==="最低價格"&&(t=t.sort((e,i)=>e.price-i.price)),this.searchText&&(t=t.filter(e=>e.title.includes(this.searchText))),t}},methods:{async getProducts(){this.isLoading=!0;try{const t=await this.$http.get(`${Ue}/v2/api/${je}/products/all`);this.products=t.data.products}catch(t){this.$swal({title:"錯誤發生",icon:"error",text:`${t.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`})}finally{this.isLoading=!1}},deleteCategory(t){this.filterCategories=this.filterCategories.filter(e=>e!==t)},resetSearch(){this.searchText=""},resetFilter(){this.filterCategories=[],this.lowPrice=null,this.highPrice=null,this.resetSearch()},changePage(t){typeof t=="number"?this.pages.current=t:t==="+"?this.pages.current++:this.pages.current--,window.scrollTo({top:0})},getPriceText(){let t=this.lowPrice,e=this.highPrice;(t==null||t==null)&&(t=""),(e==null||e==null)&&(e=""),t==""&&e==""?this.priceRangeText="":this.priceRangeText=`${t} ~ ${e}`}},watch:{"$route.query.search"(){this.$route.query.search&&(this.searchText=this.$route.query.search)},filteredList(){this.pages.total=Math.ceil(this.filteredList.length/12),this.pages.current=1},lowPrice(){this.getPriceText()},highPrice(){this.getPriceText()}},mounted(){this.$route.query.category&&this.filterCategories.push(this.$route.query.category),this.$route.query.sort&&(this.sortBy=this.$route.query.sort),this.$route.query.search&&(this.searchText=this.$route.query.search),this.getProducts()}},x=t=>(w("data-v-1afaa2ca"),t=t(),$(),t),De={class:"container px-4 lg:px-12.5"},He=x(()=>s("h2",{class:"py-6 font-size-10 md:font-size-15"},"料理",-1)),Oe={class:"flex flex-wrap items-center justify-between mb-6"},Me={action:"",class:"flex items-center gap-2 sm:gap-4"},Ge={class:"ms-auto"},Je={key:0,class:"flex gap-4 mb-6"},Ke=["onClick"],Qe=x(()=>s("div",{class:"i-material-symbols:close"},null,-1)),We=x(()=>s("div",{class:"i-material-symbols:close"},null,-1)),Xe=x(()=>s("div",{class:"i-material-symbols:close"},null,-1));function Ye(t,e,i,b,n,o){const r=g("VLoading"),d=g("CategoryFilter"),k=g("PriceFilter"),C=g("SortFilter"),L=g("ProductsList"),T=g("ProductsPagination");return l(),a(f,null,[h(r,{active:n.isLoading},null,8,["active"]),s("div",De,[He,s("div",Oe,[s("form",Me,[h(d,{modelValue:n.filterCategories,"onUpdate:modelValue":e[0]||(e[0]=c=>n.filterCategories=c)},null,8,["modelValue"]),h(k,{high:n.highPrice,"onUpdate:high":e[1]||(e[1]=c=>n.highPrice=c),low:n.lowPrice,"onUpdate:low":e[2]||(e[2]=c=>n.lowPrice=c)},null,8,["high","low"]),h(C,{modelValue:n.sortBy,"onUpdate:modelValue":e[3]||(e[3]=c=>n.sortBy=c)},null,8,["modelValue"])]),s("span",Ge,u(o.filteredList.length)+" 項料理",1)]),n.filterCategories.length!==0||n.priceRangeText!==""||n.searchText!==""?(l(),a("div",Je,[(l(!0),a(f,null,v(n.filterCategories,c=>(l(),a("button",{type:"button",class:"flex items-center gap-0.5 px-2 py-1 bg-transparent border-1px border-solid border-primary-200 rd-6 font-size-3 cursor-pointer",key:c,onClick:Ze=>o.deleteCategory(c)},[_(u(c)+" ",1),Qe],8,Ke))),128)),n.priceRangeText!==""?(l(),a("button",{key:0,type:"button",class:"flex items-center gap-0.5 px-2 py-1 bg-transparent border-1px border-solid border-primary-200 rd-6 font-size-3 cursor-pointer",onClick:e[4]||(e[4]=(...c)=>t.resetPriceRange&&t.resetPriceRange(...c))},[_(u(n.priceRangeText)+" ",1),We])):p("",!0),n.searchText!==""?(l(),a("button",{key:1,type:"button",class:"flex items-center gap-0.5 px-2 py-1 bg-transparent border-1px border-solid border-primary-200 rd-6 font-size-3 cursor-pointer",onClick:e[5]||(e[5]=(...c)=>o.resetSearch&&o.resetSearch(...c))},[_(u(n.searchText)+" ",1),Xe])):p("",!0),s("button",{type:"button",onClick:e[6]||(e[6]=(...c)=>o.resetFilter&&o.resetFilter(...c)),class:"bg-transparent border-0 font-size-3 underline underline-offset-4 cursor-pointer hover:decoration-2"}," 清除全部 ")])):p("",!0),h(L,{pages:n.pages,"filtered-list":o.filteredList,"is-loading":n.isLoading},null,8,["pages","filtered-list","is-loading"]),h(T,{pages:n.pages,onChangePage:o.changePage},null,8,["pages","onChangePage"])])],64)}const tt=m(Ae,[["render",Ye],["__scopeId","data-v-1afaa2ca"]]);export{tt as default};

import{G as C,r as f,o as $}from"./index-Yx534qpP.js";import{a as l}from"./axios-Bo0ATomq.js";import{S as o}from"./sweetalert2.all-BJRN9t4W.js";var v={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payzoom",BASE_URL:"/GDiner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const x=C("cart",()=>{const u=f({}),{VITE_URL:i,VITE_PATH:n}=v,c=f(!1);function r(){c.value=!0,l.get(`${i}/v2/api/${n}/cart`).then(t=>{u.value=t.data.data}).catch(t=>{o.fire({title:"錯誤發生",icon:"error",text:`${t.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`,confirmButtonColor:"#3D081B"})}).finally(()=>{c.value=!1})}function m(t){let e;return function(...a){clearTimeout(e),e=setTimeout(()=>{t(...a)},250)}}const d=m((t,e)=>{if(e)if(e.target.value<=0||typeof+e.target.value!="number"){o.fire({title:"數量錯誤請重新輸入",icon:"error"}),e.target.value=t.qty;return}else t.qty=+e.target.value;const a=t.id,s=t.qty;l.put(`${i}/v2/api/${n}/cart/${a}`,{data:{product_id:a,qty:s}}).then(()=>{r()}).catch(()=>{o.fire({title:"錯誤發生",icon:"error",text:"請嘗試重新整理，如果此狀況持續發生，請聯絡我們",confirmButtonColor:"#3D081B"})})});function p(t){l.delete(`${i}/v2/api/${n}/cart/${t}`).then(()=>{r(),o.fire({title:"刪除成功",icon:"success",toast:!0,position:"bottom-right",showConfirmButton:!1,timer:1500})}).catch(()=>{o.fire({title:"錯誤發生",icon:"error",text:"請嘗試重新整理，如果此狀況持續發生，請聯絡我們",confirmButtonColor:"#3D081B"})})}function B(){o.fire({title:"您確定要清空購物車嗎?",showCancelButton:!0,confirmButtonText:"都給我消失吧~~!",confirmButtonColor:"#3D081B",cancelButtonText:"取消"}).then(t=>{t.isConfirmed&&l.delete(`${i}/v2/api/${n}/carts`).then(()=>{r(),o.fire({title:"刪除成功",icon:"success",timer:2e3,confirmButtonColor:"#3D081B"})}).catch(()=>{o.fire({title:"錯誤發生",icon:"error",text:"請嘗試重新整理，如果此狀況持續發生，請聯絡我們",confirmButtonColor:"#3D081B"})})})}function h(t,e,a=!1){c.value=!0,l.post(`${i}/v2/api/${n}/cart`,{data:{product_id:t,qty:e}}).then(s=>{a||o.fire({title:`${s.data.message}`,icon:"success",timer:1e3,showConfirmButton:!1}),r()}).catch(s=>{o.fire({title:"錯誤發生",icon:"error",text:`${s.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`,confirmButtonColor:"#3D081B"})}).finally(()=>{c.value=!1})}return $(()=>{r()}),{cart:u,isLoading:c,getCart:r,addCart:h,updateCart:d,deleteCart:p,deleteCartAll:B}});export{x as u};

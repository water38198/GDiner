import{_ as O,u as P,s as H,b as G,c as J,r as C,e as g,g as c,j as l,q as o,h as e,F as D,B as K,k as x,m as Q,v as W,t as m,x as X,l as y,H as Y,S as b,C as F,f as u,L as I,n as w,z as Z,A as ee}from"./index-CgAojCB9.js";var te={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payzoom",BASE_URL:"/GDiner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const r=h=>(Z("data-v-1dd2bd22"),h=h(),ee(),h),se={class:"container px-2 md:px-12 py-10"},oe={class:"mb-10"},le={key:0,"data-aos":"fade-up"},ae={class:"flex justify-between items-center pb-7.5"},re=r(()=>e("h2",{class:"font-size-12"},"購物車",-1)),ne={class:"mb-10 pb-10 border-b-1 border-solid border-primary-200"},de={class:"block md:table w-100%"},ie=r(()=>e("thead",{class:"block md:table-header-group w-100% mb-4 border-b-1 border-solid border-primary-veryLight text-primary-200"},[e("tr",{class:"flex md:table-row justify-between"},[e("th",{class:"text-left"},"料理"),e("th",{class:"md:w-50% lg:w-60%"}),e("th",{class:"hidden md:block text-start"},"數量"),e("th",{class:"text-right"},"小計"),e("th",{class:"hidden md:block"})])],-1)),ce={class:"block md:table-row-group border-b-1 border-solid border-primary-200"},ue={class:"md:py-5 row-start-1 row-end-3 col-span-3"},me={class:"w-100% h-30 me-2 md:w-25 lg:me-10"},pe=["src","alt"],_e={class:"md:py-5 align-top col-start-4 col-end-10"},be={class:"font-size-3.5 text-primary opacity-75 lh-150%"},he={class:"md:py-5 align-top col-start-4 col-end-10"},fe={class:"md:mb-6 flex"},ve={class:"relative grid grid-cols-3 w-40 customBorder rd-3 h-10 md:h-12.5"},ge=["onClick"],xe=r(()=>e("div",{class:"i-ic:round-minus"},null,-1)),ye=[xe],we=["value","onChange"],ke=["onClick"],Ve=r(()=>e("div",{class:"i-ic:round-plus"},null,-1)),Ce=[Ve],$e={class:"row-start-1 row-end-2 col-start-10 col-end-13 ps-10 md:py-5 flex justify-end md:table-cell align-top"},ze={class:"flex justify-end items-start md:items-center h-12.5 text-nowrap"},Be={class:"col-start-10 col-end-13 md:table-cell align-top md:py-5"},Te={class:"mx-4 flex justify-end h-12.5"},Ee=["onClick"],De=r(()=>e("div",{class:"i-material-symbols:delete-outline"},null,-1)),Fe=[De],Ie={class:"block md:table-row-group"},Le={class:"block md:table-row mb-10"},Se={colspan:"5",class:"block md:table-cell w-100% pt-10 text-center md:text-start"},Ne={class:"block md:table-row"},Ue={colspan:"5",class:"block md:table-cell w-100%"},qe={class:"w-70 ms-a"},Re={class:"custom-input-group mb-4"},je=r(()=>e("label",{for:"coupon"},"優惠券",-1)),Me={key:0,class:"mb-4 text-end"},Ae={class:"mb-2"},Oe={class:"flex items-center justify-end font-size-5"},Pe=r(()=>e("h3",{class:"me-5"},"總計",-1)),He={key:0,class:"text-primary"},Ge={key:1,class:"text-red-500 font-size-6"},Je={class:"grid grid-cols-2 gap-4"},Ke=r(()=>e("h2",{class:"col-span-2 mb-10 font-size-10"},"顧客資訊",-1)),Qe={class:"custom-input-group mb-4 col-span-2"},We=r(()=>e("label",{for:"email"},"Email",-1)),Xe={class:"custom-input-group mb-4"},Ye=r(()=>e("label",{for:"姓名"},"姓名",-1)),Ze={class:"custom-input-group mb-4"},et=r(()=>e("label",{for:"電話"},"電話",-1)),tt={class:"custom-input-group mb-4 col-span-2"},st=r(()=>e("label",{for:"地址"},"地址",-1)),ot={class:"custom-input-group mb-4 col-span-2"},lt=r(()=>e("label",{for:"message"},"留言(非必須)",-1)),at=r(()=>e("div",{class:"col-span-2 text-center"},[e("button",{type:"submit",class:"max-w-50% w-100% h-12 p-x-7.5 p-y-1.5 bg-info shadow-[0_2px_0_0_#3D081B] text-secondary border-0 rd-10 cursor-pointer hover:shadow-none hover:bg-info-dark"},"送出訂單")],-1)),rt={key:1,class:"pb-20"},nt=r(()=>e("h2",{class:"mb-7 font-size-8 md:font-size-12 lh-tight font-serif text-center"}," 目前購物車為空 (´⊙ω⊙`)",-1)),dt={class:"text-center"},it={__name:"CartView",setup(h){const{VITE_URL:$,VITE_PATH:z}=te,B=P(),{cart:d,isLoading:L}=H(B),S=G(),N=J(()=>{const a=[];return d.value.carts&&d.value.carts.forEach(s=>a.push(s.product.id)),a}),{getCart:U,updateCart:k,deleteCart:q,deleteCartAll:T}=B,f=C([]),i=C({user:{email:"",name:"",tel:"",address:""},message:""}),p=C("");function R(){if(d.value.carts.length===0){b.fire({icon:"error",title:"目前沒有東西在購物車喔~"});return}f.value.push("userForm"),F.post(`${$}/v2/api/${z}/order`,{data:i.value}).then(a=>{b.fire({title:a.data.message,icon:"success",confirmButtonColor:"#3D081B",confirmButtonText:"複製"}).then(s=>{s.isConfirmed&&navigator.clipboard.writeText(`${a.data.orderId}`),S.push(`order?id=${a.data.orderId}`)})}).catch(a=>{b.fire({title:"錯誤發生",icon:"error",text:`${a.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`,confirmButtonColor:"#3D081B"})}).finally(()=>{f.value.splice(f.value.indexOf("userForm"),1)})}function j(){p.value&&F.post(`${$}/v2/api/${z}/coupon`,{data:{code:p.value}}).then(a=>{b.fire({icon:"success",title:`${a.data.message}`,toast:!0,position:"bottom-end",timer:1500,showConfirmButton:!1}),p.value="",U()}).catch(a=>{b.fire({icon:"error",title:`${a.response.data.message}`})})}function M(a){return/^(09)[0-9]{8}$/.test(a)?!0:"請輸入正確的電話號碼"}return(a,s)=>{var E;const V=g("RouterLink"),_=g("VField"),v=g("ErrorMessage"),A=g("VForm");return u(),c(D,null,[l(o(I),{active:o(L)},null,8,["active"]),e("div",se,[e("div",oe,[((E=o(d).carts)==null?void 0:E.length)>0?(u(),c("div",le,[e("div",ae,[re,e("button",{type:"button",class:"bg-transparent border-0 underline underline-offset-4 cursor-pointer hover:text-primary-light",onClick:s[0]||(s[0]=(...t)=>o(T)&&o(T)(...t))},"清空購物車")]),e("div",ne,[e("table",de,[ie,e("tbody",ce,[(u(!0),c(D,null,K(o(d).carts,t=>(u(),c("tr",{key:t.id+"123",class:"grid gap-2 grid-rows-[repeat(2,auto)] grid-cols-[repeat(12,1fr)] md:table-row w-100% mb-6"},[e("td",ue,[e("div",me,[e("img",{src:t.product.imageUrl,alt:`${t.product.title}的照片`,class:"block max-w-25 w-100% h-100% border-2 border-solid border-primary rd-2.5"},null,8,pe)])]),e("td",_e,[e("div",null,[l(V,{to:`/product/${t.product.id}`,class:"block mb-2 lh-normal hover:underline hover:underline-offset-4 hover:decoration-2"},{default:x(()=>[y(m(t.product.title),1)]),_:2},1032,["to"]),e("div",null,[e("span",be," NT$"+m(t.product.price),1)])])]),e("td",he,[e("div",fe,[e("div",ve,[e("button",{type:"button",class:"block bg-transparent border-0 px-4 cursor-pointer font-size-5 fw-900",onClick:n=>{t.qty-1>0&&t.qty--,o(k)(t)}},ye,8,ge),e("input",{type:"number",name:"",id:"quantity",value:t.qty,class:"block bg-transparent border-0 appearance-none outline-0 w-100% text-center font-size-4",min:"1",onChange:n=>o(k)(t,n)},null,40,we),e("button",{type:"button",class:"block bg-transparent border-0 px-4 cursor-pointer font-size-5 fw-900",onClick:n=>{t.qty++,o(k)(t)}},Ce,8,ke)])])]),e("td",$e,[e("span",ze,"NT$ "+m(Math.floor(t.final_total)),1)]),e("td",Be,[e("div",Te,[e("button",{type:"button",class:"bg-transparent border-0 font-size-6 cursor-pointer px-0 hover:opacity-60",onClick:n=>o(q)(t.id)},Fe,8,Ee)])])]))),128))]),e("tfoot",Ie,[e("tr",Le,[e("td",Se,[l(V,{to:"/products",class:"tracking-widest underline underline-offset-4 hover:decoration-2"},{default:x(()=>[y(" 繼續購物 ")]),_:1})])]),e("tr",Ne,[e("td",Ue,[e("div",qe,[e("div",Re,[Q(e("input",{type:"text",name:"coupon",id:"coupon",class:"block w-100% p-x-3 p-y-1.5 border-1 border-solid border-#dee2e6 rd",placeholder:"請輸入 優惠券","onUpdate:modelValue":s[1]||(s[1]=t=>p.value=t)},null,512),[[W,p.value,void 0,{trim:!0}]]),je,e("button",{type:"button",class:"absolute right-0 top-50% translate-y--50% block h-100% border-0 bg-transparent p-x-3 p-y-1.5 border-l-2 border-solid border-primary rd-r-3 cursor-pointer hover:bg-primary hover:text-secondary",onClick:j},"使用")]),o(d).carts[0].coupon?(u(),c("div",Me,[e("p",Ae,"已套用優惠券代碼："+m(o(d).carts[0].coupon.code),1),e("p",null,"折扣金額： -"+m(Math.floor(o(d).total-o(d).final_total)),1)])):X("",!0)]),e("div",null,[e("div",Oe,[Pe,o(d).total==o(d).final_total?(u(),c("p",He,[y("NT$ "),e("span",null,m(o(d).total),1)])):(u(),c("p",Ge,"NT$"+m(Math.floor(o(d).final_total)),1))])])])])])])]),e("div",null,[l(o(I),{active:f.value.includes("userForm")},null,8,["active"]),l(A,{class:"md:w-75% mx-auto",onSubmit:R,autocomplete:"off"},{default:x(({errors:t})=>[e("div",Je,[Ke,e("div",Qe,[l(_,{type:"email",name:"email",id:"email",class:w({invalid:t.email}),placeholder:"請輸入 Email",rules:"required|email",modelValue:i.value.user.email,"onUpdate:modelValue":s[2]||(s[2]=n=>i.value.user.email=n)},null,8,["class","modelValue"]),We,l(v,{name:"email",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",Xe,[l(_,{type:"text",name:"姓名",id:"name",class:w({invalid:t.姓名}),rules:"required",placeholder:"請輸入 姓名",modelValue:i.value.user.name,"onUpdate:modelValue":s[3]||(s[3]=n=>i.value.user.name=n)},null,8,["class","modelValue"]),Ye,l(v,{name:"姓名",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",Ze,[l(_,{type:"tel",name:"電話",id:"tel",class:w({invalid:t.電話}),rules:M,placeholder:"請輸入 電話",modelValue:i.value.user.tel,"onUpdate:modelValue":s[4]||(s[4]=n=>i.value.user.tel=n)},null,8,["class","modelValue"]),et,l(v,{name:"電話",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",tt,[l(_,{type:"address",name:"地址",id:"address",class:w({invalid:t.地址}),rules:"required",placeholder:"請輸入 地址",modelValue:i.value.user.address,"onUpdate:modelValue":s[5]||(s[5]=n=>i.value.user.address=n)},null,8,["class","modelValue"]),st,l(v,{name:"地址",class:"absolute block left-3 bottom--5 text-red-500 font-size-3"})]),e("div",ot,[l(_,{as:"textarea",name:"userForm.message",id:"message",cols:"30",rows:"10",modelValue:i.value.message,"onUpdate:modelValue":s[6]||(s[6]=n=>i.value.message=n),placeholder:"請輸入留言"},null,8,["modelValue"]),lt]),at])]),_:1})])])):(u(),c("div",rt,[nt,e("div",dt,[l(V,{to:"/products",class:"inline-block bg-info text-secondary tracking-widest px-5 py-3 rd-100vh shadow-[0_2px_0_0_#3D081B] hover:shadow-[0_1px_0_0_#3D081B]"},{default:x(()=>[y(" 趕緊購物去 ")]),_:1})])]))]),l(Y,{exclude:N.value},null,8,["exclude"])])],64)}}},ut=O(it,[["__scopeId","data-v-1dd2bd22"]]);export{ut as default};

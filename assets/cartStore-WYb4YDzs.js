import{E as v,r as f,o as $}from"./index-BGcmftwk.js";import{a as l,S as s}from"./sweetalert2.all-BG_37rGc.js";var _={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payzoom",BASE_URL:"/GDiner/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const E=v("cart",()=>{const u=f({}),{VITE_URL:n,VITE_PATH:c}=_,o=f(!1);function r(){o.value=!0,l.get(`${n}/v2/api/${c}/cart`).then(t=>{u.value=t.data.data,console.log(u.value)}).catch(t=>{s.fire({title:"錯誤發生",icon:"error",text:`${t.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`,confirmButtonColor:"#3D081B"})}).finally(()=>{o.value=!1})}function d(t){let e;return function(...a){clearTimeout(e),e=setTimeout(()=>{t(...a)},250)}}const m=d((t,e)=>{if(e)if(e.target.value<=0||typeof+e.target.value!="number"){s.fire({title:"數量錯誤請重新輸入",icon:"error"}),e.target.value=t.qty;return}else t.qty=+e.target.value;const a=t.id,i=t.qty;l.put(`${n}/v2/api/${c}/cart/${a}`,{data:{product_id:a,qty:i}}).then(()=>{r()}).catch(h=>{console.log(h)})});function p(t){l.delete(`${n}/v2/api/${c}/cart/${t}`).then(()=>{r(),s.fire({title:"刪除成功",icon:"success",toast:!0,position:"bottom-right",showConfirmButton:!1,timer:1500})}).catch(e=>{console.log(e)})}function g(t,e,a=!1){o.value=!0,l.post(`${n}/v2/api/${c}/cart`,{data:{product_id:t,qty:e}}).then(i=>{a||s.fire({title:`${i.data.message}`,icon:"success",timer:1e3,showConfirmButton:!1}),r()}).catch(i=>{s.fire({title:"錯誤發生",icon:"error",text:`${i.response.data.message}，請嘗試重新整理，如果此狀況持續發生，請聯絡我們`,confirmButtonColor:"#3D081B"})}).finally(()=>{o.value=!1})}return $(()=>{r()}),{cart:u,isLoading:o,getCart:r,addCart:g,updateCart:m,deleteCart:p}});export{E as u};
